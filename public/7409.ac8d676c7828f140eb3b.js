"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[7409],{7409:(ue,T,a)=>{a.r(T),a.d(T,{BranchesModule:()=>ce});var c=a(8583),e=a(7716),A=a(6234),u=a(5593),d=a(3423),g=a(5108),v=a(9529),h=a(805),C=a(1740),q=a(7489);function w(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"span",11),e._UZ(2,"i",12),e.TgZ(3,"input",13),e.NdJ("input",function(s){return e.CHM(t),e.oxw(),e.MAs(9).filterGlobal(s.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}function S(r,o){if(1&r&&(e.TgZ(0,"th",15),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&r){const t=o.$implicit;e.Q6J("id",t),e.xp6(1),e.Oqu(e.lcZ(2,2,t))}}function Q(r,o){if(1&r&&(e.TgZ(0,"tr"),e.YNc(1,S,3,4,"th",14),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.headersTable)}}function E(r,o){1&r&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-skeleton"),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"p-skeleton"),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-skeleton"),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"p-skeleton"),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"p-skeleton"),e.qZA(),e.qZA())}function F(r,o){if(1&r&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.qZA()),2&r){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.ruc_sucursal),e.xp6(2),e.Oqu(t.nombre_sucursal),e.xp6(2),e.Oqu(t.provincia_sucursal),e.xp6(2),e.Oqu(t.ciudad_sucursal),e.xp6(2),e.Oqu(t.telefono_sucursal)}}function Y(r,o){if(1&r&&(e.YNc(0,E,11,0,"tr",16),e.YNc(1,F,11,5,"tr",16)),2&r){const t=e.oxw();e.Q6J("ngIf",0===t.branches.length),e.xp6(1),e.Q6J("ngIf",t.branches.length>0)}}const O=function(){return["ruc_sucursal","nombre_sucursal","provincia_sucursal"]},P=function(){return[10,20,40]};let k=(()=>{class r{constructor(t){this.branchService=t,this.headersTable=["Ruc","Nombre","Provincia","Ciudad","Tel\xe9fono"]}get branches(){return this.branchService.branches}ngOnInit(){this.branchService.findAll()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(A.p))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-branches"]],decls:13,vars:9,consts:[[1,"p-5","w-screen"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Agregar","icon","pi pi-plus","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50","routerLink","nueva"],[1,"w-full","pt-3"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","450px",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[4,"ngIf"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"div",1),e.TgZ(3,"h1",2),e._uU(4,"Sucursales"),e.qZA(),e._UZ(5,"p-button",3),e.qZA(),e._UZ(6,"p-divider"),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"p-table",5,6),e.YNc(10,w,4,0,"ng-template",7),e.YNc(11,Q,2,1,"ng-template",8),e.YNc(12,Y,2,2,"ng-template",9),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.Q6J("scrollable",0!==n.branches.length)("value",0===n.branches.length?n.headersTable.concat(n.headersTable):n.branches)("paginator",!0)("globalFilterFields",e.DdM(7,O))("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(8,P)))},directives:[u.zx,d.rH,g.i,v.iA,h.jx,C.o,c.sg,c.O5,q.O],pipes:[c.rS],encapsulation:2}),r})();var i=a(3679),H=a(6118),R=a(1256),p=a(3738),B=a(1095),b=a(6627),Z=a(1795),m=a(8295),M=a(9983),U=a(5396),_=a(1554),N=a(2453),y=a(8239),V=a(7074),I=a(1512),J=a(3631),f=a(6457);function z(r,o){if(1&r&&e._UZ(0,"agm-marker",8),2&r){const t=e.oxw();e.Q6J("latitude",t.marketPosition.lat)("longitude",t.marketPosition.lng)}}let L=(()=>{class r{constructor(t){this.mapService=t,this.open=!1,this.closeMapModal=new e.vpe,this.saveAddress=new e.vpe,this.placeValue=""}ngOnInit(){this.mapService.setCurrentLocation()}get location(){return this.mapService.cords}get optionsPlaces(){return this.mapService.optionsAutocomplete}closeModal(){this.closeMapModal.emit(!1)}setNewLocation(t){var n=this;return(0,y.Z)(function*(){n.valueToAddress=yield n.mapService.getNewLocation(t.coords),n.marketPosition=t.coords})()}setValuePlace(t){this.mapService.getOptionPlaces(t.query)}selectNewPlace(t){var n=this;return(0,y.Z)(function*(){yield n.mapService.fromPlaceIdToCoords(t.place_id)})()}handlerAddPosition(){this.saveAddress.emit(this.valueToAddress),this.open=!1}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(V.S))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-map-branch"]],inputs:{open:"open"},outputs:{closeMapModal:"closeMapModal",saveAddress:"saveAddress"},decls:9,vars:11,consts:[["header","Agregar direcci\xf3n","styleClass","w-1/2",3,"visible","visibleChange","onHide"],[1,"grid","grid-cols-1"],[1,"font-medium"],[1,"p-fluid","mt-2","mb-4"],["field","description",3,"ngModel","suggestions","showEmptyMessage","minLength","showClear","ngModelChange","completeMethod","onSelect"],[1,"w-full","h-100",3,"latitude","longitude","zoom","mapClick"],[3,"latitude","longitude",4,"ngIf"],["pButton","","pRipple","","label","Agregar","icon","pi pi-save",1,"p-button-sm","p-button-rounded","bg-companySecondary","border-white","mt-4",3,"disabled","click"],[3,"latitude","longitude"]],template:function(t,n){1&t&&(e.TgZ(0,"p-dialog",0),e.NdJ("visibleChange",function(l){return n.open=l})("onHide",function(){return n.closeModal()}),e.TgZ(1,"div",1),e.TgZ(2,"h5",2),e._uU(3,"Buscar direcci\xf3n"),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"p-autoComplete",4),e.NdJ("ngModelChange",function(l){return n.placeValue=l})("completeMethod",function(l){return n.setValuePlace(l)})("onSelect",function(l){return n.selectNewPlace(l)}),e.qZA(),e.qZA(),e.TgZ(6,"agm-map",5),e.NdJ("mapClick",function(l){return n.setNewLocation(l)}),e.YNc(7,z,1,2,"agm-marker",6),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return n.handlerAddPosition()}),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("visible",n.open),e.xp6(5),e.Q6J("ngModel",n.placeValue)("suggestions",n.optionsPlaces)("showEmptyMessage",!0)("minLength",3)("showClear",!0),e.xp6(1),e.Q6J("latitude",n.location.lat)("longitude",n.location.lng)("zoom",15),e.xp6(1),e.Q6J("ngIf",n.marketPosition),e.xp6(1),e.Q6J("disabled",!n.marketPosition))},directives:[I.V,J.Qc,i.JJ,i.On,f.SA,c.O5,u.Hq,Z.H,f.pt],styles:[""]}),r})();var x=a(4885),j=a(2458);const G=["formBranch"];function $(r,o){1&r&&e._UZ(0,"mat-progress-spinner",35),2&r&&e.Q6J("diameter",24)("mode","indeterminate")}function D(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function X(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function W(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function K(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function ee(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function te(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function re(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function ne(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function oe(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function ae(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}function ie(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"mat-option",36),e.NdJ("onSelectionChange",function(){const l=e.CHM(t).$implicit;return e.oxw().selectValue(l)}),e._uU(1),e.qZA()}if(2&r){const t=o.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.ruc," ")}}function se(r,o){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El campo es obligatorio* "),e.qZA())}const le=[{path:"",component:k},{path:"nueva",component:(()=>{class r{constructor(t,n,s,l){this.formBuilder=t,this.companiesService=n,this.branchService=s,this.messageService=l,this.open=!0,this.filterOptions=[],this.openMapModal=!1}get companies(){return this.companiesService.companies}ngOnInit(){this.companiesService.findAll(),this.newBranch=this.formBuilder.group({codigo_sucursal:[(0,H.Z)().toString().split("-")[0],[i.kI.required]],ruc_sucursal:["",[i.kI.required]],nombre_sucursal:["",[i.kI.required]],direccion_sucursal:["",[i.kI.required]],provincia_sucursal:["",[i.kI.required]],ciudad_sucursal:["",[i.kI.required]],telefono_sucursal:["",[i.kI.required]],numero_licencia_sucursal:["",[i.kI.required]],contacto_sucursal:["",[i.kI.required]],email_contacto_sucursal:["",[i.kI.required]],numero_registro_generador_desechos:["",[i.kI.required]],estado_sucursal:[!0,[i.kI.required]],id_razon_social:["",[i.kI.required]],representante:[""],descripcion:[""]})}displayFn(t){return t&&t.ruc?t.ruc:""}selectValue(t){this.newBranch.patchValue({representante:t.name,descripcion:t.representative})}changeValue(t){this.filterOptions=this.companiesService.filterByRuc(t)}handlerNewBranch(){!this.newBranch.valid||(this.newBranch.disable(),this.newBranch.patchValue({id_razon_social:this.newBranch.value.id_razon_social.id,estado_sucursal:this.newBranch.value.estado_sucursal?1:0}),delete this.newBranch.value.representante,delete this.newBranch.value.descripcion,this.branchService.create(this.newBranch.value).subscribe(t=>{this.messageService.add({severity:"success",detail:"Sucursal agregada correctamente",summary:"Transacci\xf3n existosa"}),this.newBranch.enable(),this.newBranch.reset()}))}handlerMapModal(t){this.openMapModal=t}handlerSetAddress(t){this.newBranch.patchValue({direccion_sucursal:`${t.coords.lat}, ${t.coords.lng}`,provincia_sucursal:t.country,ciudad_sucursal:t.city}),this.openMapModal=!1}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.qu),e.Y36(R.Q),e.Y36(A.p),e.Y36(h.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-branch"]],viewQuery:function(t,n){if(1&t&&e.Gf(G,5),2&t){let s;e.iGM(s=e.CRH())&&(n.formBranch=s.first)}},features:[e._Bn([h.ez])],decls:100,vars:18,consts:[[1,"p-5","w-full"],[1,"grid","grid-cols-2"],[1,"flex","justify-start","gap-4","items-center"],["mat-mini-fab","","color","primary","routerLink",".."],[1,"text-3xl","font-bold"],[1,"flex","justify-end"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-sm","p-button-rounded","bg-companySecondary","border-white","w-50",3,"disabled","click"],[3,"diameter","mode",4,"ngIf"],["autocomplete","off",3,"formGroup"],["formBranch","ngForm"],[1,"text-xl","font-bold","underline"],[1,"mt-3","grid","grid-cols-4","gap-3"],["matInput","","formControlName","ruc_sucursal"],[4,"ngIf"],["matInput","","formControlName","nombre_sucursal"],["matInput","","formControlName","telefono_sucursal"],["matInput","","formControlName","numero_licencia_sucursal"],["matInput","","formControlName","contacto_sucursal"],["matInput","","formControlName","email_contacto_sucursal"],["matInput","","formControlName","numero_registro_generador_desechos"],[1,"flex","flex-col","justify-center"],["color","primary","formControlName","estado_sucursal"],[1,"grid","grid-cols-4","gap-4","mt-3"],[1,"col-span-2"],["matInput","","formControlName","direccion_sucursal",3,"click"],["matInput","","formControlName","provincia_sucursal","readonly",""],["matInput","","formControlName","ciudad_sucursal","readonly",""],[1,"grid","grid-cols-3","mt-3","gap-4"],["matInput","","formControlName","id_razon_social",3,"matAutocomplete","ngModelChange"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["matInput","","readonly","","formControlName","representante"],["matInput","","readonly","","formControlName","descripcion"],[3,"open","closeMapModal","saveAddress"],[3,"diameter","mode"],[3,"value","onSelectionChange"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"mat-card"),e.TgZ(2,"mat-card-title"),e.TgZ(3,"div",1),e.TgZ(4,"div",2),e.TgZ(5,"button",3),e.TgZ(6,"mat-icon"),e._uU(7,"arrow_back"),e.qZA(),e.qZA(),e.TgZ(8,"h1",4),e._uU(9,"Nueva sucursal"),e.qZA(),e.qZA(),e.TgZ(10,"div",5),e.TgZ(11,"button",6),e.NdJ("click",function(){return n.handlerNewBranch()}),e.YNc(12,$,1,2,"mat-progress-spinner",7),e.qZA(),e.qZA(),e.qZA(),e._UZ(13,"p-divider"),e.qZA(),e.TgZ(14,"mat-card-content"),e.TgZ(15,"form",8,9),e.TgZ(17,"div"),e.TgZ(18,"h1",10),e._uU(19,"Datos de sucursal"),e.qZA(),e.TgZ(20,"div",11),e.TgZ(21,"mat-form-field"),e.TgZ(22,"mat-label"),e._uU(23,"Ruc"),e.qZA(),e._UZ(24,"input",12),e.YNc(25,D,2,0,"mat-error",13),e.qZA(),e.TgZ(26,"mat-form-field"),e.TgZ(27,"mat-label"),e._uU(28,"Nombre"),e.qZA(),e._UZ(29,"input",14),e.YNc(30,X,2,0,"mat-error",13),e.qZA(),e.TgZ(31,"mat-form-field"),e.TgZ(32,"mat-label"),e._uU(33,"Tel\xe9fono"),e.qZA(),e._UZ(34,"input",15),e.YNc(35,W,2,0,"mat-error",13),e.qZA(),e.TgZ(36,"mat-form-field"),e.TgZ(37,"mat-label"),e._uU(38,"Licencia"),e.qZA(),e._UZ(39,"input",16),e.YNc(40,K,2,0,"mat-error",13),e.qZA(),e.TgZ(41,"mat-form-field"),e.TgZ(42,"mat-label"),e._uU(43,"Contacto"),e.qZA(),e._UZ(44,"input",17),e.YNc(45,ee,2,0,"mat-error",13),e.qZA(),e.TgZ(46,"mat-form-field"),e.TgZ(47,"mat-label"),e._uU(48,"Correo Electr\xf2nico"),e.qZA(),e._UZ(49,"input",18),e.YNc(50,te,2,0,"mat-error",13),e.qZA(),e.TgZ(51,"mat-form-field"),e.TgZ(52,"mat-label"),e._uU(53,"N\xb0 de registro"),e.qZA(),e._UZ(54,"input",19),e.YNc(55,re,2,0,"mat-error",13),e.qZA(),e.TgZ(56,"div",20),e.TgZ(57,"mat-slide-toggle",21),e._uU(58,"Estado"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(59,"div"),e.TgZ(60,"h1",10),e._uU(61,"Datos de direcci\xf3n"),e.qZA(),e.TgZ(62,"div",22),e.TgZ(63,"mat-form-field",23),e.TgZ(64,"mat-label"),e._uU(65,"Direcci\xf3n"),e.qZA(),e.TgZ(66,"input",24),e.NdJ("click",function(){return n.handlerMapModal(!0)}),e.qZA(),e.YNc(67,ne,2,0,"mat-error",13),e.qZA(),e.TgZ(68,"mat-form-field"),e.TgZ(69,"mat-label"),e._uU(70,"Provincia"),e.qZA(),e._UZ(71,"input",25),e.YNc(72,oe,2,0,"mat-error",13),e.qZA(),e.TgZ(73,"mat-form-field"),e.TgZ(74,"mat-label"),e._uU(75,"Ciudad"),e.qZA(),e._UZ(76,"input",26),e.YNc(77,ae,2,0,"mat-error",13),e.qZA(),e.qZA(),e.qZA(),e.TgZ(78,"div"),e.TgZ(79,"h1",10),e._uU(80,"Raz\xf3n social"),e.qZA(),e.TgZ(81,"div",27),e.TgZ(82,"mat-form-field"),e.TgZ(83,"mat-label"),e._uU(84,"Ruc"),e.qZA(),e.TgZ(85,"input",28),e.NdJ("ngModelChange",function(l){return n.changeValue(l)}),e.qZA(),e.TgZ(86,"mat-autocomplete",29,30),e.YNc(88,ie,2,2,"mat-option",31),e.qZA(),e.YNc(89,se,2,0,"mat-error",13),e.qZA(),e.TgZ(90,"mat-form-field"),e.TgZ(91,"mat-label"),e._uU(92,"Representante"),e.qZA(),e._UZ(93,"input",32),e.qZA(),e.TgZ(94,"mat-form-field"),e.TgZ(95,"mat-label"),e._uU(96,"Descripci\xf3n"),e.qZA(),e._UZ(97,"input",33),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(98,"p-toast"),e.TgZ(99,"app-map-branch",34),e.NdJ("closeMapModal",function(l){return n.handlerMapModal(l)})("saveAddress",function(l){return n.handlerSetAddress(l)}),e.qZA()),2&t){const s=e.MAs(87);e.xp6(11),e.Q6J("disabled",n.newBranch.disabled),e.xp6(1),e.Q6J("ngIf",n.newBranch.disabled),e.xp6(3),e.Q6J("formGroup",n.newBranch),e.xp6(10),e.Q6J("ngIf",n.newBranch.get("ruc_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("nombre_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("telefono_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("numero_licencia_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("contacto_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("email_contacto_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("numero_registro_generador_desechos").hasError("required")),e.xp6(12),e.Q6J("ngIf",n.newBranch.get("direccion_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("provincia_sucursal").hasError("required")),e.xp6(5),e.Q6J("ngIf",n.newBranch.get("ciudad_sucursal").hasError("required")),e.xp6(8),e.Q6J("matAutocomplete",s),e.xp6(1),e.Q6J("displayWith",n.displayFn),e.xp6(2),e.Q6J("ngForOf",n.filterOptions),e.xp6(1),e.Q6J("ngIf",n.newBranch.get("id_razon_social").hasError("required")),e.xp6(10),e.Q6J("open",n.openMapModal)}},directives:[p.a8,p.n5,B.lW,d.rH,b.Hw,u.Hq,Z.H,c.O5,g.i,p.dn,i._Y,i.JL,i.sg,m.KE,m.hX,M.Nt,i.Fj,i.JJ,i.u,U.Rr,_.ZL,_.XC,c.sg,N.FN,L,x.Ou,m.TO,j.ey],styles:[""]}),r})()}];let ce=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[c.ez,d.Bz.forChild(le),u.hJ,g.x,v.U$,C.j,q.m,I.S,m.lN,M.c,B.ot,b.Ps,U.rP,p.QW,i.UX,x.Cq,Z.T,_.Bb,i.u5,N.EV,f.su,J.WN]]}),r})()}}]);