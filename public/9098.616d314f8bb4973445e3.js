"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[9098],{9098:(A,h,o)=>{o.r(h),o.d(h,{LocationModule:()=>ne});var d=o(8583),p=o(2238),e=o(7716),f=o(9075);let C=(()=>{class i{constructor(t,n,r){this.data=t,this.dialogRef=n,this.sanitizer=r}ngOnInit(){console.log(this.data)}urlSafe(t){return console.log(t),this.sanitizer.bypassSecurityTrustResourceUrl(t)}cerrar(){this.dialogRef.close()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.WI),e.Y36(p.so),e.Y36(f.H7))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-video"]],decls:7,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["id","inlineFrameExample","title","Inline Frame Example","width","500","height","500",3,"src"],["mat-dialog-actions",""],["mat-button","",1,"border-2","mt-2","text-xl","p-2","rounded-md",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1),e._UZ(3,"iframe",2),e.TgZ(4,"div",3),e.TgZ(5,"button",4),e.NdJ("click",function(){return n.cerrar()}),e._uU(6,"Cerrar"),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.hij("Camara de ",n.data.devicename,""),e.xp6(2),e.Q6J("src",n.urlSafe(n.data.urlVideo),e.uOi))},styles:[""]}),i})();var s=o(6457),m=o(3729),g=o(6991),v=o(5108),y=o(8295),_=o(7441),b=o(2177),x=o(5593),T=o(1795),E=o(2458);const F=["search"];function w(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"agm-marker",13),e.NdJ("dragEnd",function(r){const c=e.CHM(t).$implicit;return e.oxw().handleDrag(r,c.id)}),e.qZA()}if(2&i){const t=a.$implicit;e.Q6J("latitude",t.position.lat)("longitude",t.position.lng)("markerDraggable",!0)}}function I(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"agm-marker",14),e.NdJ("dragEnd",function(r){const c=e.CHM(t).$implicit;return e.oxw().handleDrag(r,c.id)}),e.qZA()}if(2&i){const t=a.$implicit,n=e.oxw();e.Q6J("latitude",t.lat)("longitude",t.lng)("iconUrl",n.urlIcon)("markerDraggable",!0)}}const S=function(i,a){return{lat:i,lng:a}};function O(i,a){if(1&i&&e._UZ(0,"agm-direction",16),2&i){const t=e.oxw().$implicit;e.Q6J("destination",t.destination)("origin",e.WLB(2,S,t.lat,t.lng))}}function z(i,a){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,O,1,5,"agm-direction",15),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",t.visible&&t.destination)}}function M(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"agm-marker",17),e.TgZ(1,"agm-info-window"),e.TgZ(2,"div",18),e.TgZ(3,"h2",19),e._uU(4),e.qZA(),e.TgZ(5,"h3",20),e._uU(6,"Dispositivo"),e.qZA(),e.TgZ(7,"h3",21),e._uU(8),e.qZA(),e.TgZ(9,"h3",20),e._uU(10,"Flota"),e.qZA(),e.TgZ(11,"h3",21),e._uU(12),e.qZA(),e.TgZ(13,"h3",20),e._uU(14,"Velocidad"),e.qZA(),e.TgZ(15,"h3",21),e._uU(16),e.qZA(),e.TgZ(17,"button",22),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().viewCamera(l)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=a.$implicit,n=e.oxw();e.Q6J("latitude",t.latitude)("longitude",t.longitude)("iconUrl",n.urlIcon2),e.xp6(4),e.hij(" ",t.devicename," "),e.xp6(4),e.Oqu(t.deviceguid),e.xp6(4),e.Oqu(t.fleetname),e.xp6(4),e.hij("",t.speed," Km/h")}}function U(i,a){if(1&i&&(e.TgZ(0,"mat-option",23),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}let L=(()=>{class i{constructor(t,n,r,l,c,u){this._mapsAPILoader=t,this.ngZone=n,this.driversService=r,this.internarlVehiclesService=l,this.sanitizer=c,this._matDialog=u,this.urlIcon={url:"./assets/icons/vehicle-icon.svg",scaledSize:{width:40,height:60}},this.urlIcon2={url:"./assets/icons/camion.svg",scaledSize:{width:40,height:60}},this.vehicles=[{id:1,market:{lat:-.24760574202618602,lng:-78.50391469031592},lat:-.24760574202618602,lng:-78.50391469031592,plate:"ABC123",driver:"Carlos Aguas",weight:"100Kg",destination:{lat:-.243212231704593,lng:-78.49716839261214},visible:!1},{id:2,market:{lat:-.25230475446628225,lng:-78.49079140221122},lat:-.25230475446628225,lng:-78.49079140221122,plate:"ABC123",driver:"Carlos Aguas",weight:"100Kg",visible:!1},{id:3,market:{lat:-.24110415662532048,lng:-78.4776582670751},lat:-.24110415662532048,lng:-78.4776582670751,plate:"ABC123",driver:"Carlos Aguas",weight:"100Kg",visible:!1},{id:4,market:{lat:-.2347569010933538,lng:-78.49382779755152},lat:-.2347569010933538,lng:-78.49382779755152,plate:"ABC123",driver:"Carlos Aguas",weight:"100Kg",visible:!1},{id:5,market:{lat:-.23771384390782055,lng:-78.53168091803809},lat:-.23771384390782055,lng:-78.53168091803809,plate:"ABC123",driver:"Carlos Aguas",weight:"100Kg",visible:!1},{id:6,market:{lat:-.2544463678769816,lng:-78.47692023145623},lat:-.2544463678769816,lng:-78.47692023145623,plate:"ABC123",driver:"Carlos Aguas",weight:"100Kg",visible:!1}],this.puntos=[],this.newEventDialog=!1,this.viewEventsDialog=!1,this.data=[],this.distrits=[],this.selectDistrict=1,this.pointsDrivers=[],this.listVehicles=[]}ngOnInit(){this._mapsAPILoader.load().then(()=>{this.setCurrentLocation(),this.geocoder=new google.maps.Geocoder}),this.driversService.getDistrict("1").subscribe(t=>{this.distrits=t}),this.driversService.getUbication().subscribe(t=>{t.messageBody&&(0===this.pointsDrivers.length?this.pointsDrivers.push(t.messageBody):this.pointsDrivers.map(n=>{n.driverId===t.messageBody.driverId?(n.lat=parseFloat(t.messageBody.lat),n.lng=parseFloat(t.messageBody.lng)):this.pointsDrivers.push(t.messageBody)}))}),this.internarlVehiclesService.loginHowen().subscribe(t=>{this.internarlVehiclesService.listVehicle(t.token).subscribe(n=>{let r=[];r=n.dataList.map(l=>Object.assign(Object.assign({},l),{urlVideo:"http://velax.teragon.com.pe:9966/vss/apiPage/RealVideo.html?token="+t.token+"&deviceId="+l.deviceguid+"&chs=1_3&stream=0&wnum=4&panel=1&buffer=2000"})),console.log(r),this.listVehicles=r})})}selectionAddress(t){this.loadPoints(t.value)}loadPoints(t){this.driversService.getAddress(t).subscribe(n=>{let r=[];console.log(n),n.forEach(l=>{const c=l.coords.split(","),u={position:{lat:parseFloat(c[0]),lng:parseFloat(c[1])},name:l.name,id:l.id};r=[...r,u]}),this.puntos=r})}setCurrentLocation(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude},t=>{console.log(t),this.lat=-12.040607,this.lng=-77.040365})}visibleDirection(t){this.vehicles=this.vehicles.map(n=>n.id===t?Object.assign(Object.assign({},n),{visible:!0}):n)}showNewEventDialog(){this.newEventDialog=!0}showViewEventsDialog(){this.viewEventsDialog=!0}closeDialog(t){this.newEventDialog=t}onClickMap(t){this.showNewEventDialog(),this.latEvent=t.coords.lat,this.lngEvent=t.coords.lng}addEvent(t){this.data.push(t)}closeDialogData(t){this.viewEventsDialog=t}closeAddEvent(t){this.newEventDialog=t}handleDrag(t,n){console.log(t,n),this.driversService.updatePoints(n,{name:"",coords:`${t.coords.lat},${t.coords.lng}`}).subscribe(l=>{console.log(l)})}pruebaFun(t){return this.sanitizer.bypassSecurityTrustResourceUrl("http://velax.teragon.com.pe:9966/vss/apiPage/RealVideo.html?token=cf4616085d58487d9196d2512556d2e1&deviceId="+t+"&chs=1_3&stream=0&wnum=2&panel=1&buffer=2000")}viewCamera(t){console.log(t),this._matDialog.open(C,{width:"600px",data:t}).afterClosed().subscribe(r=>{console.log(r)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.W7),e.Y36(e.R0b),e.Y36(m.P),e.Y36(g.Z),e.Y36(f.H7),e.Y36(p.uw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-location"]],viewQuery:function(t,n){if(1&t&&e.Gf(F,5),2&t){let r;e.iGM(r=e.CRH())&&(n.search=r.first)}},decls:17,vars:11,consts:[[1,"w-full"],[1,"w-full","h-full",3,"latitude","longitude","zoom","disableDoubleClickZoom","fullscreenControl","mapDblClick"],["class","w-5 h-5",3,"latitude","longitude","markerDraggable","dragEnd",4,"ngFor","ngForOf"],["class","w-5 h-5",3,"latitude","longitude","iconUrl","markerDraggable","dragEnd",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","w-5 h-5",3,"latitude","longitude","iconUrl",4,"ngFor","ngForOf"],[1,"p-3","m-3","bg-white","rounded","absolute","top-0","left-0","drop-shadow-xl"],[1,"grid","grid-flow-col","auto-cols-max","place-items-center"],[1,"text-3xl","font-bold","mr-2"],["layout","vertical"],["id","combo",1,"md:w-100","sm:w-50"],[3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"w-5","h-5",3,"latitude","longitude","markerDraggable","dragEnd"],[1,"w-5","h-5",3,"latitude","longitude","iconUrl","markerDraggable","dragEnd"],[3,"destination","origin",4,"ngIf"],[3,"destination","origin"],[1,"w-5","h-5",3,"latitude","longitude","iconUrl"],[1,"grid","grid-cols-2","gap-2","h-auto"],[1,"font-bold","text-2xl","col-span-2","flex","justify-center"],[1,"font-bold","text-lg"],[1,"text-lg"],["pButton","","pRipple","","label","Ver c\xe1maras",1,"bg-primary","p-button-sm",3,"click"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"agm-map",1),e.NdJ("mapDblClick",function(l){return n.onClickMap(l)}),e.YNc(2,w,1,3,"agm-marker",2),e.YNc(3,I,1,4,"agm-marker",3),e.YNc(4,z,2,1,"div",4),e.YNc(5,M,18,7,"agm-marker",5),e.qZA(),e.TgZ(6,"div",6),e.TgZ(7,"div",7),e.TgZ(8,"h1",8),e._uU(9,"Mapa"),e.qZA(),e._UZ(10,"p-divider",9),e.TgZ(11,"mat-form-field",10),e.TgZ(12,"mat-label"),e._uU(13,"Distritos"),e.qZA(),e.TgZ(14,"mat-select",11),e.NdJ("selectionChange",function(l){return n.selectionAddress(l)}),e.YNc(15,U,2,2,"mat-option",12),e.qZA(),e.qZA(),e._UZ(16,"p-divider",9),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("latitude",n.lat)("longitude",n.lng)("zoom",14)("disableDoubleClickZoom",!0)("fullscreenControl",!0),e.xp6(1),e.Q6J("ngForOf",n.puntos),e.xp6(1),e.Q6J("ngForOf",n.pointsDrivers),e.xp6(1),e.Q6J("ngForOf",n.vehicles),e.xp6(1),e.Q6J("ngForOf",n.listVehicles),e.xp6(9),e.Q6J("value",n.selectDistrict),e.xp6(1),e.Q6J("ngForOf",n.distrits))},directives:[s.SA,d.sg,v.i,y.KE,y.hX,_.gD,s.pt,d.O5,b.w,s.d,x.Hq,T.H,E.ey],encapsulation:2}),i})();var k=o(3423),Z=o(1740),J=o(805);let N=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez],J.m8]}),i})();var D=o(3679),P=o(1769),R=o(7489),Y=o(9529),$=o(369),H=o(2453),K=o(1512),W=o(9983),X=o(1095),q=o(4885),G=o(3425),ee=o(6627),te=o(2210);const ie=[{path:"",component:L}];let ne=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez,k.Bz.forChild(ie),v.x,s.su,Z.j,x.hJ,T.T,N,D.UX,P.t,x.hJ,T.T,R.m,Y.U$,d.ez,$.n,H.EV,K.S,D.UX,y.lN,W.c,X.ot,q.Cq,G.gz,Z.j,ee.Ps,te.kW,b.i,_.LD,p.Is]]}),i})()},5108:(A,h,o)=>{o.d(h,{i:()=>f,x:()=>C});var d=o(7716),p=o(8583);const e=["*"];let f=(()=>{class s{constructor(){this.layout="horizontal",this.type="solid"}containerClass(){return{"p-divider p-component":!0,"p-divider-horizontal":"horizontal"===this.layout,"p-divider-vertical":"vertical"===this.layout,"p-divider-solid":"solid"===this.type,"p-divider-dashed":"dashed"===this.type,"p-divider-dotted":"dotted"===this.type,"p-divider-left":"horizontal"===this.layout&&(!this.align||"left"===this.align),"p-divider-center":"horizontal"===this.layout&&"center"===this.align||"vertical"===this.layout&&(!this.align||"center"===this.align),"p-divider-right":"horizontal"===this.layout&&"right"===this.align,"p-divider-top":"vertical"===this.layout&&"top"===this.align,"p-divider-bottom":"vertical"===this.layout&&"bottom"===this.align}}}return s.\u0275fac=function(g){return new(g||s)},s.\u0275cmp=d.Xpm({type:s,selectors:[["p-divider"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",layout:"layout",type:"type",align:"align"},ngContentSelectors:e,decls:3,vars:4,consts:[["role","separator",3,"ngClass","ngStyle"],[1,"p-divider-content"]],template:function(g,v){1&g&&(d.F$t(),d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.Hsn(2),d.qZA(),d.qZA()),2&g&&(d.Tol(v.styleClass),d.Q6J("ngClass",v.containerClass())("ngStyle",v.style))},directives:[p.mk,p.PC],styles:['.p-divider-horizontal{display:flex;width:100%;position:relative;align-items:center}.p-divider-horizontal:before{position:absolute;display:block;top:50%;left:0;width:100%;content:""}.p-divider-horizontal.p-divider-left{justify-content:flex-start}.p-divider-horizontal.p-divider-right{justify-content:flex-end}.p-divider-horizontal.p-divider-center{justify-content:center}.p-divider-content{z-index:1}.p-divider-vertical{min-height:100%;margin:0 1rem;display:flex;position:relative;justify-content:center}.p-divider-vertical:before{position:absolute;display:block;top:0;left:50%;height:100%;content:""}.p-divider-vertical.p-divider-top{align-items:flex-start}.p-divider-vertical.p-divider-center{align-items:center}.p-divider-vertical.p-divider-bottom{align-items:flex-end}.p-divider-solid.p-divider-horizontal:before{border-top-style:solid}.p-divider-solid.p-divider-vertical:before{border-left-style:solid}.p-divider-dashed.p-divider-horizontal:before{border-top-style:dashed}.p-divider-dashed.p-divider-vertical:before{border-left-style:dashed}.p-divider-dotted.p-divider-horizontal:before{border-top-style:dotted}.p-divider-dotted.p-divider-horizontal:before{border-left-style:dotted}\n'],encapsulation:2,changeDetection:0}),s})(),C=(()=>{class s{}return s.\u0275fac=function(g){return new(g||s)},s.\u0275mod=d.oAB({type:s}),s.\u0275inj=d.cJS({imports:[[p.ez]]}),s})()}}]);