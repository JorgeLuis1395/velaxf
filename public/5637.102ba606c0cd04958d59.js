"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[5637],{5637:(qt,x,n)=>{n.r(x),n.d(x,{ReceptionModule:()=>xt});var p=n(8583),d=n(805),t=n(7716),q=n(1124),Z=n(5108),C=n(9529),h=n(2453),R=n(1740),U=n(7489),v=n(5593),y=n(1795),I=n(1436),m=n(3423);function M(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",9),t.TgZ(1,"span",10),t._UZ(2,"i",11),t.TgZ(3,"input",12),t.NdJ("input",function(r){return t.CHM(e),t.oxw(),t.MAs(8).filterGlobal(r.target.value,"contains")}),t.qZA(),t.qZA(),t.qZA()}}function S(i,a){if(1&i&&(t.TgZ(0,"th",14),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&i){const e=a.$implicit;t.Q6J("id",e),t.xp6(1),t.Oqu(t.lcZ(2,2,e))}}function Y(i,a){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,S,3,4,"th",13),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.headersTable)}}function O(i,a){1&i&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._UZ(2,"p-skeleton"),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"p-skeleton"),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"p-skeleton"),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"p-skeleton"),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"p-skeleton"),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"p-skeleton"),t.qZA(),t.qZA())}const E=function(i){return["edit",i]};function W(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t._UZ(13,"button",16),t.TgZ(14,"button",17),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit;return t.oxw().handleDelete(r.id)}),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(2),t.hij("B00",e.numRequest,""),t.xp6(2),t.Oqu(t.xi3(5,6,e.dateReception,"shortDate")),t.xp6(3),t.Oqu(e.hourReception),t.xp6(2),t.Oqu(e.totalWeight),t.xp6(2),t.Oqu(null==e||null==e.unity?null:e.unity.name),t.xp6(2),t.Q6J("routerLink",t.VKq(9,E,e.id))}}function P(i,a){if(1&i&&(t.YNc(0,O,13,0,"tr",15),t.YNc(1,W,15,11,"tr",15)),2&i){const e=t.oxw();t.Q6J("ngIf",null===e.receptions),t.xp6(1),t.Q6J("ngIf",e.receptions)}}const w=function(){return["processNumber","customer.businessName"]},B=function(){return[10,20,40]};let j=(()=>{class i{constructor(e,o){this.receptionService=e,this.messageService=o,this.headersTable=["Manifiesto","Fecha de recepci\xf3n","Hora de recepci\xf3n","Peso","Unidad","Acciones"],this.receptions=null}ngOnInit(){this.receptionService.getAllReception().then(e=>{this.receptions=e.data.data.receptions})}handleDelete(e){this.receptionService.deleteReception(e).then(o=>{this.messageService.add({severity:"success",detail:o.data.data.removeReception,summary:"Transacci\xf3n correcta"}),this.receptionService.getAllReception().then(r=>{this.receptions=r.data.data.receptions})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(q.G),t.Y36(d.ez))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-reception"]],features:[t._Bn([d.ez])],decls:13,vars:9,consts:[[1,"p-5","w-screen"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],[1,"w-full","pt-3"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","450px",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-eye","matTooltip","Ver detalles",1,"p-button-rounded","p-button-outlined","mr-2",3,"routerLink"],["pButton","","pRipple","","type","button","icon","pi pi-trash","matTooltip","Eliminar",1,"p-button-rounded","p-button-outlined","mr-2","p-button-danger",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div"),t.TgZ(2,"div",1),t.TgZ(3,"h1",2),t._uU(4,"Recepciones"),t.qZA(),t.qZA(),t._UZ(5,"p-divider"),t.qZA(),t.TgZ(6,"div",3),t.TgZ(7,"p-table",4,5),t.YNc(9,M,4,0,"ng-template",6),t.YNc(10,Y,2,1,"ng-template",7),t.YNc(11,P,2,2,"ng-template",8),t.qZA(),t.qZA(),t._UZ(12,"p-toast"),t.qZA()),2&e&&(t.xp6(7),t.Q6J("scrollable",null!==o.receptions)("value",null===o.receptions?o.headersTable.concat(o.headersTable):o.receptions)("paginator",!0)("globalFilterFields",t.DdM(7,w))("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(8,B)))},directives:[Z.i,C.iA,d.jx,h.FN,R.o,p.sg,p.O5,U.O,v.Hq,y.H,I.gM,m.rH],pipes:[p.rS,p.uU],encapsulation:2}),i})();var s=n(3679),H=n(3190),D=n(2927),T=n(4885),V=n(1769),u=n(8295),F=n(9983),b=n(7441),_=n(1095),g=n(3220),N=n(2458),A=n(7648),J=n(6627);function z(i,a){1&i&&(t.TgZ(0,"div",3),t.TgZ(1,"div",4),t._UZ(2,"mat-spinner",5),t.qZA(),t.qZA()),2&i&&(t.xp6(2),t.Q6J("diameter",50)("mode","indeterminate"))}function $(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"El campo el obligatorio "),t.qZA())}function L(i,a){if(1&i&&(t.TgZ(0,"mat-form-field"),t.TgZ(1,"mat-label"),t._uU(2,"Fecha de recepci\xf3n"),t.qZA(),t._UZ(3,"input",21),t._UZ(4,"mat-datepicker-toggle",22),t._UZ(5,"mat-datepicker",null,23),t.YNc(7,$,2,0,"mat-error",2),t.qZA()),2&i){const e=t.MAs(6),o=t.oxw(2);t.xp6(3),t.Q6J("matDatepicker",e),t.xp6(1),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",o.receptionForm.get("dateReception").hasError("required"))}}function G(i,a){1&i&&(t.TgZ(0,"mat-form-field"),t.TgZ(1,"mat-label"),t._uU(2,"Fecha de recepci\xf3n"),t.qZA(),t._UZ(3,"input",13),t.qZA()),2&i&&(t.xp6(3),t.Q6J("formControlName","dateReception"))}function k(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"El campo el obligatorio "),t.qZA())}function X(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Por favor ingrese un peso "),t.qZA())}function K(i,a){if(1&i&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function tt(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Por favor ingrese una unidad de peso "),t.qZA())}function et(i,a){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Por favor ingrese un peso "),t.qZA())}function it(i,a){1&i&&(t.TgZ(0,"mat-list",28),t.TgZ(1,"mat-list-item"),t.TgZ(2,"div",29),t.TgZ(3,"h1",30),t._uU(4,"Mae"),t.qZA(),t.TgZ(5,"h1",31),t._uU(6,"Descripci\xf3n"),t.qZA(),t.TgZ(7,"h1",30),t._uU(8,"Cantidad"),t.qZA(),t.TgZ(9,"h1",30),t._uU(10,"Unidad"),t.qZA(),t.TgZ(11,"h1",30),t._uU(12,"Cantidad Ajustada"),t.qZA(),t.qZA(),t.qZA(),t.qZA())}function ot(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"a",35),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit;return t.oxw(3).handlerRemove(r)}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t.qZA()}}function nt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-list",28),t.TgZ(1,"mat-list-item"),t.TgZ(2,"div",32),t.TgZ(3,"h1"),t._uU(4),t.qZA(),t.TgZ(5,"h1",11),t._uU(6),t.qZA(),t.TgZ(7,"h1"),t._uU(8),t.qZA(),t.TgZ(9,"h1"),t._uU(10),t.qZA(),t.TgZ(11,"mat-form-field"),t.TgZ(12,"input",33),t.NdJ("change",function(r){const l=t.CHM(e).$implicit;return t.oxw(3).handleChangeValue(l,r)}),t.qZA(),t.qZA(),t.TgZ(13,"div"),t.YNc(14,ot,3,0,"a",34),t.qZA(),t.qZA(),t.qZA(),t._UZ(15,"p-divider"),t.qZA()}if(2&i){const e=a.$implicit,o=t.oxw(3);t.xp6(4),t.Oqu(e.maeId.name),t.xp6(2),t.Oqu(e.maeId.description),t.xp6(2),t.Oqu(e.weight),t.xp6(2),t.Oqu(o.unidad),t.xp6(2),t.Q6J("value",e.weightReception),t.xp6(2),t.Q6J("ngIf",(o.rolComercial||o.rolAdmin)&&o.isFirst)}}function rt(i,a){if(1&i&&(t.TgZ(0,"div",25),t.YNc(1,it,13,0,"mat-list",26),t.YNc(2,nt,16,6,"mat-list",27),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0!==e.detailMae.length),t.xp6(1),t.Q6J("ngForOf",e.detailMae)}}function at(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.isVisibleMae?"Notificar":"Guardar"," ")}}function st(i,a){1&i&&t._UZ(0,"mat-progress-spinner",5),2&i&&t.Q6J("diameter",24)("mode","indeterminate")}const ct=function(){return["/reception"]};function lt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",6),t.TgZ(2,"h1",7),t._uU(3),t.qZA(),t._UZ(4,"p-button",8),t.qZA(),t._UZ(5,"mat-divider"),t.TgZ(6,"form",9,10),t.TgZ(8,"mat-form-field",11),t.TgZ(9,"mat-label"),t._uU(10,"Manifiesto"),t.qZA(),t._UZ(11,"input",12),t.qZA(),t.YNc(12,L,8,3,"mat-form-field",2),t.YNc(13,G,4,1,"mat-form-field",2),t.TgZ(14,"mat-form-field"),t.TgZ(15,"mat-label"),t._uU(16,"Hora de recepci\xf3n"),t.qZA(),t._UZ(17,"input",13),t.YNc(18,k,2,0,"mat-error",2),t.qZA(),t.TgZ(19,"mat-form-field"),t.TgZ(20,"mat-label"),t._uU(21,"Peso Total B\xe1scula"),t.qZA(),t._UZ(22,"input",14),t.YNc(23,X,2,0,"mat-error",2),t.qZA(),t.TgZ(24,"mat-form-field"),t.TgZ(25,"mat-label"),t._uU(26,"Unidad de Peso"),t.qZA(),t.TgZ(27,"mat-select",15),t.YNc(28,K,2,2,"mat-option",16),t.qZA(),t.YNc(29,tt,2,0,"mat-error",2),t.qZA(),t.TgZ(30,"mat-form-field"),t.TgZ(31,"mat-label"),t._uU(32,"Peso Total Recepcion"),t.qZA(),t._UZ(33,"input",14),t.YNc(34,et,2,0,"mat-error",2),t.qZA(),t.TgZ(35,"mat-form-field"),t.TgZ(36,"mat-label"),t._uU(37,"Peso Total Solicitud"),t.qZA(),t._UZ(38,"input",17),t.qZA(),t._UZ(39,"br"),t.YNc(40,rt,3,2,"div",18),t.TgZ(41,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().addReception()}),t.YNc(42,at,2,1,"span",2),t.YNc(43,st,1,2,"mat-progress-spinner",20),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.receptionId?"Ver":"Agregar"," recepci\xf3n "),t.xp6(1),t.Q6J("routerLink",t.DdM(21,ct)),t.xp6(2),t.Q6J("formGroup",e.receptionForm),t.xp6(5),t.Q6J("value",e.numRequest),t.xp6(1),t.Q6J("ngIf",0===e.receptionId),t.xp6(1),t.Q6J("ngIf",0!==e.receptionId),t.xp6(4),t.Q6J("formControlName","hourReception"),t.xp6(1),t.Q6J("ngIf",e.receptionForm.get("hourReception").hasError("required")),t.xp6(4),t.Q6J("formControlName","totalWeight"),t.xp6(1),t.Q6J("ngIf",e.receptionForm.get("totalWeight").hasError("required")),t.xp6(4),t.Q6J("formControlName","unity"),t.xp6(1),t.Q6J("ngForOf",e.unity),t.xp6(1),t.Q6J("ngIf",e.receptionForm.get("unity").hasError("required")),t.xp6(4),t.Q6J("formControlName","totalWeightReception"),t.xp6(1),t.Q6J("ngIf",e.receptionForm.get("totalWeightReception").hasError("required")),t.xp6(4),t.Q6J("value",e.total),t.xp6(2),t.Q6J("ngIf",e.isVisibleMae),t.xp6(1),t.Q6J("color","primary")("disabled",e.receptionForm.disabled),t.xp6(1),t.Q6J("ngIf",!e.receptionForm.disabled),t.xp6(1),t.Q6J("ngIf",e.receptionForm.disabled)}}let Q=(()=>{class i{constructor(e,o,r,c,l,f){this.receptionService=e,this.messageService=o,this._formBuilder=r,this._requestService=c,this.activatedRoute=l,this.router=f,this.receptionId=0,this.loading=!0,this.pipe=new p.uU("en-US"),this.total=0,this.isVisibleMae=!1,this.detailMae=[]}ngOnInit(){if(this._requestService.getCatalogo("UNITYWEIGHT").subscribe(e=>this.unity=e.catalog.detailCatalog),this._requestService.getCatalogo("NTIFICATIONSTATUS").subscribe(e=>this.statusNotification=e.catalog.detailCatalog),!this.router.url.includes("edit"))return this.receptionForm=this._formBuilder.group({dateReception:[,[s.kI.required]],hourReception:[,[s.kI.required]],totalWeight:[,s.kI.required],unity:[,s.kI.required],request:[,s.kI.required],totalWeightReception:[]}),void(this.loading=!1);this.activatedRoute.params.pipe((0,H.w)(({id:e})=>this.receptionService.getIdReception(e))).subscribe(e=>{var o;const r=e.data.data.reception;this.receptionForm=this._formBuilder.group({dateReception:[this.pipe.transform(r.dateReception,"MM/dd/yyyy"),[s.kI.required]],hourReception:[r.hourReception,[s.kI.required]],totalWeight:[r.totalWeight,s.kI.required],unity:[null===(o=null==r?void 0:r.unity)||void 0===o?void 0:o.id,s.kI.required],request:[r.request,s.kI.required],totalWeightReception:[null==r?void 0:r.totalWeightReception]}),this.idRequest=r.request,this.receptionService.getById(r.request).subscribe(c=>{this.contract=c.request.contract,console.log(c.request.contract),this.numRequest="B00"+c.request.numRequest,this.detailMae=c.request.detail,c.request.detail.map(l=>{this.total+=l.weight}),this.unidad=c.request.unity.name}),this.loading=!1,this.receptionId=r.id})}handleChangeValue(e,o){e.weightReception=parseFloat(o.target.value)}addReception(){if(this.receptionForm.invalid)return;this.receptionForm.disable();const e={id:this.receptionId,totalWeight:parseFloat(this.receptionForm.value.totalWeight),totalWeightReception:parseFloat(this.receptionForm.value.totalWeightReception),unity:this.receptionForm.value.unity};this.isVisibleMae?this.detailMae.forEach((o,r)=>{let c;if(console.log(o),this.contract){const l=this.contract.detail.find(f=>f.mae.id===o.maeId.id);c={weightReception:o.weightReception,detailContractId:l.id}}else c={weightReception:o.weightReception};this.receptionService.updateMae(o.id,c).subscribe(l=>{this.detailMae.length-1===r&&this.createNoti()},l=>{this.messageService.add({severity:"error",detail:l.error.message,summary:"Transacci\xf3n fallida"}),this.receptionForm.enable()})}):this.receptionService.updateReception(e).then(o=>{if(!o.data.data)return this.messageService.add({severity:"error",detail:o.data.errors[0].message,summary:"Transacci\xf3n erronea"}),this.receptionForm.enable(),void(this.isVisibleMae=!0);this.messageService.add({severity:"success",detail:"Se creo correctamente la recepci\xf3n",summary:"Transacci\xf3n correcta"}),this.isVisibleMae=!1,this.router.navigate(["/reception"])}).catch(()=>{this.receptionForm.enable(),this.messageService.add({severity:"error",detail:"Error al ingresar el contrato",summary:"Transacci\xf3n fallida"})})}createNoti(){const e=this.statusNotification.filter(r=>"PENDIENTE"===r.name);this.receptionService.createNotification({request:this.idRequest,status:e[0].id}).then(r=>{this.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se notifico el cambio de mae al administrador"}),setTimeout(()=>{this.router.navigate(["/reception"])},2e3)}).catch(r=>console.log(r))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(q.G),t.Y36(d.ez),t.Y36(s.qu),t.Y36(D.s),t.Y36(m.gz),t.Y36(m.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-add"]],features:[t._Bn([d.ez])],decls:4,vars:2,consts:[[1,"p-5","w-screen"],["class","grid justify-items-stretch",4,"ngIf"],[4,"ngIf"],[1,"grid","justify-items-stretch"],[1,"justify-self-center","pt-50"],[3,"diameter","mode"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Regresar","icon","pi pi-angle-left","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],[1,"grid","gap-4","md:grid-cols-3","sm:grid-cols-2","mt-2","bg-white","p-3",3,"formGroup"],["vehicleInNgForm","ngForm"],[1,"col-span-2"],["type","text","matInput","",3,"value"],["type","text","matInput","","readonly","",3,"formControlName"],["type","text","matInput","",3,"formControlName"],["name","unity",3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","readonly","",3,"value"],["class","col-span-3 border-2 border-colorCompany",4,"ngIf"],["mat-flat-button","",1,"fuse-mat-button-medium","mt-6","w-1/2",3,"color","disabled","click"],[3,"diameter","mode",4,"ngIf"],["matInput","","formControlName","dateReception",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],[3,"value"],[1,"col-span-3","border-2","border-colorCompany"],["class","w-full",4,"ngIf"],["class","w-full",4,"ngFor","ngForOf"],[1,"w-full"],[1,"grid","grid-cols-6","gap-3","w-full"],[1,"font-bold"],[1,"font-bold","col-span-2"],[1,"grid","grid-cols-6","gap-3","w-full","items-center","mb-1"],["type","number","matInput","",3,"value","change"],["mat-flat-button","","id","mae","color","primary",3,"click",4,"ngIf"],["mat-flat-button","","id","mae","color","primary",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.YNc(1,z,3,2,"div",1),t.YNc(2,lt,44,22,"div",2),t._UZ(3,"p-toast"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading))},directives:[p.O5,h.FN,T.$g,v.zx,m.rH,V.d,s._Y,s.JL,s.sg,u.KE,u.hX,F.Nt,s.Fj,s.JJ,s.u,b.gD,p.sg,_.lW,g.hl,g.nW,u.R9,g.Mq,u.TO,N.ey,A.i$,A.Tg,Z.i,_.zs,J.Hw,T.Ou],styles:[""]}),i})();var pt=n(1512),dt=n(7913),mt=n(3520),ut=n(3631),gt=n(6457),ft=n(2613),Zt=n(5396),ht=n(2210),vt=n(5722),Tt=n(3738),_t=n(1554);const At=[{path:"",component:j},{path:"add",component:Q},{path:"edit/:id",component:Q}];let xt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.ez,m.Bz.forChild(At),Z.x,C.U$,U.m,h.EV,R.j,v.hJ,y.T,pt.S,s.UX,dt.Iu,mt.zz,_.ot,T.Cq,J.Ps,I.AV,u.lN,F.c,A.ie,ut.WN,s.u5,gt.su,b.LD,ft.Fk,g.FA,N.XK,Zt.rP,ht.kW,vt.q4,Tt.QW,_t.Bb]]}),i})()}}]);