"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[2844],{2844:(Zt,S,l)=>{l.r(S),l.d(S,{CertificateModule:()=>wt});var d=l(8583),u=l(805),e=l(7716),C=l(1256),g=l(5593),_=l(3423),y=l(5108),M=l(9529),T=l(2453),U=l(1740),D=l(7489),h=l(4885),v=l(1795),E=l(1436);function z(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"span",11),e._UZ(2,"i",12),e.TgZ(3,"input",13),e.NdJ("input",function(a){return e.CHM(t),e.oxw(),e.MAs(9).filterGlobal(a.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}function R(i,o){if(1&i&&(e.TgZ(0,"th",15),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=o.$implicit;e.Q6J("id",t),e.xp6(1),e.hij(" ",e.lcZ(2,2,t)," ")}}function Y(i,o){if(1&i&&(e.TgZ(0,"tr"),e.YNc(1,R,3,4,"th",14),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.headersTable)}}function V(i,o){1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-skeleton"),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"p-skeleton"),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-skeleton"),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"p-skeleton"),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"p-skeleton"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"p-skeleton"),e.qZA(),e.qZA())}function H(i,o){1&i&&e._UZ(0,"mat-progress-spinner",20),2&i&&e.Q6J("diameter",25)}const j=function(i){return["edit",i]};function $(i,o){if(1&i&&e._UZ(0,"button",21),2&i){const t=e.oxw(2).$implicit;e.Q6J("routerLink",e.VKq(1,j,t.id))}}function G(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit;return e.oxw().handleDownload(a.id)}),e.qZA()}}function W(i,o){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e.YNc(14,H,1,1,"mat-progress-spinner",17),e.YNc(15,$,1,3,"button",18),e.YNc(16,G,1,0,"button",19),e.qZA(),e.qZA()),2&i){const t=e.oxw().$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.processNumber),e.xp6(2),e.Oqu(e.xi3(5,8,t.duration,"shortDate")),e.xp6(3),e.Oqu(e.xi3(8,11,t.createdAt,"shortDate")),e.xp6(3),e.Oqu(t.customer.businessName),e.xp6(2),e.hij(" ",t.hasDocument?"Si":"No"," "),e.xp6(2),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading)}}function K(i,o){if(1&i&&(e.YNc(0,V,13,0,"tr",16),e.YNc(1,W,17,14,"tr",16)),2&i){const t=e.oxw();e.Q6J("ngIf",null===t.contrate),e.xp6(1),e.Q6J("ngIf",t.contrate)}}const X=function(){return["add"]},ee=function(){return["processNumber","customer.businessName"]},te=function(){return[10,20,40]};let ie=(()=>{class i{constructor(t,n){this.companyService=t,this.messageService=n,this.contrate=null,this.loading=!1,this.headersTable=["Proceso Nro","Duraci\xf3n","Fecha de creacion","Cliente","Documento","Acciones"]}ngOnInit(){this.companyService.getContract("").then(t=>{const n=t.data.data.contracts;n.map(a=>{a.createdAt=new Date(a.createdAt)}),this.contrate=n.sort((a,s)=>s.createdAt-a.createdAt)}).catch(t=>console.log(t))}handleDownload(t){this.loading=!0,this.companyService.dowloadContract(t).then(n=>{if(n.data.data.document.document){let r=`data:application/pdf;base64,${n.data.data.document.document}`,p=document.createElement("a");p.setAttribute("href",r),p.setAttribute("download",`Clausulas-${t}.pdf`),p.setAttribute("target","_blank"),document.body.appendChild(p),p.click(),document.body.removeChild(p)}let a=`${n.data.data.document.detailDocument}`,s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download",`Detalle-${t}.pdf`),s.setAttribute("target","_blank"),document.body.appendChild(s),s.click(),document.body.removeChild(s),this.loading=!1}).catch(n=>{this.messageService.add({severity:"error",detail:"Transacci\xf3n erronea",summary:"No se pudo generar el documento"}),this.loading=!1})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.Q),e.Y36(u.ez))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-certificate"]],features:[e._Bn([u.ez])],decls:14,vars:11,consts:[[1,"p-5","w-screen"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Agregar","icon","pi pi-plus","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],[1,"w-full","pt-3"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","450px",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[4,"ngIf"],["mode","indeterminate",3,"diameter",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-eye","class","p-button-rounded p-button-outlined mr-2","matTooltip","Ver detalles",3,"routerLink",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-arrow-circle-down","class","p-button-rounded p-button-outlined mr-2","matTooltip","Descargar certificado",3,"click",4,"ngIf"],["mode","indeterminate",3,"diameter"],["pButton","","pRipple","","type","button","icon","pi pi-eye","matTooltip","Ver detalles",1,"p-button-rounded","p-button-outlined","mr-2",3,"routerLink"],["pButton","","pRipple","","type","button","icon","pi pi-arrow-circle-down","matTooltip","Descargar certificado",1,"p-button-rounded","p-button-outlined","mr-2",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"div",1),e.TgZ(3,"h1",2),e._uU(4,"Contratos"),e.qZA(),e._UZ(5,"p-button",3),e.qZA(),e._UZ(6,"p-divider"),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"p-table",5,6),e.YNc(10,z,4,0,"ng-template",7),e.YNc(11,Y,2,1,"ng-template",8),e.YNc(12,K,2,2,"ng-template",9),e.qZA(),e.qZA(),e._UZ(13,"p-toast"),e.qZA()),2&t&&(e.xp6(5),e.Q6J("routerLink",e.DdM(8,X)),e.xp6(3),e.Q6J("scrollable",null!==n.contrate)("value",null===n.contrate?n.headersTable.concat(n.headersTable):n.contrate)("paginator",!0)("globalFilterFields",e.DdM(9,ee))("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(10,te)))},directives:[g.zx,_.rH,y.i,M.iA,u.jx,T.FN,U.o,d.sg,d.O5,D.O,h.Ou,g.Hq,v.H,E.gM],pipes:[d.rS,d.uU],styles:[""]}),i})();var N=l(1512),c=l(3679),ne=l(7913),ae=l(3520),x=l(1095),k=l(6627),m=l(8295),w=l(9983),Z=l(7648),q=l(3631),oe=l(6457),se=l(7441),re=l(2613),b=l(3220),O=l(2458),le=l(5396),ce=l(2210),L=l(5722),A=l(3738),F=l(1554),pe=l(3190),de=l(6118),me=l(2927),B=l(7539);const ue=["customId"];function fe(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo es obligatorio*"),e.qZA())}function ge(i,o){if(1&i&&(e.TgZ(0,"mat-form-field",7),e.TgZ(1,"mat-label"),e._uU(2,"Nombre grupo"),e.qZA(),e._UZ(3,"input",14),e.YNc(4,fe,2,0,"mat-error",10),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("formControlName","groupName"),e.xp6(1),e.Q6J("ngIf",t.newDetail.get("groupName").hasError("required"))}}const _e=function(){return{width:"100%"}},he=function(){return{color:"red"}};function ve(i,o){if(1&i&&(e.TgZ(0,"div",2),e.TgZ(1,"mat-label"),e._uU(2,"Maes"),e.qZA(),e._UZ(3,"br"),e._UZ(4,"p-multiSelect",15),e.qZA()),2&i){const t=e.oxw();e.xp6(4),e.Akn(e.DdM(5,_e)),e.Q6J("panelStyle",e.DdM(6,he))("options",t.catalogMae)("formControlName","mae")}}function xe(i,o){1&i&&e._uU(0),2&i&&e.hij(" ",o.$implicit.name," ")}function be(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Ce(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"label"),e._uU(2,"Mae"),e.qZA(),e.TgZ(3,"p-autoComplete",16,17),e.NdJ("completeMethod",function(a){return e.CHM(t),e.oxw().filterOptionMae(a)})("onSelect",function(a){return e.CHM(t),e.oxw().select(a)}),e.YNc(5,xe,1,1,"ng-template",18),e.qZA(),e.YNc(6,be,2,0,"mat-error",10),e.qZA()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("suggestions",t.maes),e.xp6(3),e.Q6J("ngIf",t.newDetail.get("mae").hasError("required"))}}function ye(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo es obligatorio*"),e.qZA())}function Te(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo es obligatorio*"),e.qZA())}function we(i,o){1&i&&(e.TgZ(0,"span"),e._uU(1,"Guardar"),e.qZA())}function Ze(i,o){1&i&&e._UZ(0,"mat-progress-spinner",19),2&i&&e.Q6J("diameter",25)}let Ae=(()=>{class i{constructor(t,n,a){this.fromBuilder=t,this.companyService=n,this._requestService=a,this.open=!1,this.setOpen=new e.vpe,this.dataDetail=new e.vpe,this.maes=[],this.isGroup=!1}set type(t){void 0!==t&&(this.newDetail=this.fromBuilder.group("P\xdaBLICO"===t?{groupName:[""],mae:[,c.kI.required],price:[,c.kI.required],weight:[,c.kI.required]}:{groupName:[""],mae:[,c.kI.required],price:[],weight:[]}))}get catalogMae(){return this._requestService.maeCatalog}ngOnInit(){this._requestService.getCatalogMae(),this.newDetail=this.fromBuilder.group({groupName:[""],mae:[,c.kI.required],price:[,c.kI.required],weight:[,c.kI.required]})}handlerClose(t){this.setOpen.emit(t)}filterOptionMae(t){this.companyService.getMae(t.query).subscribe(n=>{this.maes=n.mae},n=>console.log(n))}select(t){this.auto.inputFieldValue=(t.name+"-"+t.description).trim()}handlerCreate(){!this.newDetail.valid||(console.log(this.newDetail.value.mae.length),console.log(this.newDetail.value),this.dataDetail.emit(this.newDetail.value),this.newDetail.disable(),this.newDetail.reset(),this.newDetail.enable())}selectGroup(t){console.log("first",t),this.newDetail.patchValue({mae:null}),this.isGroup=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.qu),e.Y36(C.Q),e.Y36(me.s))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-detail"]],viewQuery:function(t,n){if(1&t&&e.Gf(ue,5),2&t){let a;e.iGM(a=e.CRH())&&(n.auto=a.first)}},inputs:{open:"open",type:"type"},outputs:{setOpen:"setOpen",dataDetail:"dataDetail"},decls:26,vars:12,consts:[["header","Nuevo Detalle","styleClass","w-1/2 ",3,"visible","visibleChange","onHide"],["autocomplete","off",1,"grid","grid-cols-2","gap-2",3,"formGroup"],[1,"w-full","col-span-2","flex","flex-col","p-fluid"],["color","primary",1,"example-margin",3,"change"],["class","w-full col-span-2",4,"ngIf"],["class","w-full col-span-2 flex flex-col p-fluid ",4,"ngIf"],["class","w-full col-span-2 flex flex-col p-fluid",4,"ngIf"],[1,"w-full","col-span-2"],["matPrefix",""],["matInput","","type","number",3,"formControlName"],[4,"ngIf"],["matSuffix",""],["mat-flat-button","",1,"bg-companySecondary","text-white","mt-3",3,"disabled","click"],["mode","indeterminate",3,"diameter",4,"ngIf"],["matInput","","type","text",3,"formControlName"],["label","Mae","optionLabel","name",3,"panelStyle","options","formControlName"],["styleClass","w-full","formControlName","mae",3,"suggestions","completeMethod","onSelect"],["customId",""],["pTemplate","item"],["mode","indeterminate",3,"diameter"]],template:function(t,n){1&t&&(e.TgZ(0,"p-dialog",0),e.NdJ("visibleChange",function(s){return n.open=s})("onHide",function(){return n.handlerClose(!1)}),e.TgZ(1,"div"),e.TgZ(2,"form",1),e.TgZ(3,"div",2),e.TgZ(4,"mat-checkbox",3),e.NdJ("change",function(s){return n.selectGroup(s.checked)}),e._uU(5,"Agrupar"),e.qZA(),e.qZA(),e.YNc(6,ge,5,2,"mat-form-field",4),e.YNc(7,ve,5,7,"div",5),e.YNc(8,Ce,7,2,"div",6),e.TgZ(9,"mat-form-field",7),e.TgZ(10,"mat-label"),e._uU(11,"Precio"),e.qZA(),e.TgZ(12,"span",8),e._uU(13,"$ \xa0"),e.qZA(),e._UZ(14,"input",9),e.YNc(15,ye,2,0,"mat-error",10),e.qZA(),e.TgZ(16,"mat-form-field",7),e.TgZ(17,"mat-label"),e._uU(18,"Peso"),e.qZA(),e._UZ(19,"input",9),e.TgZ(20,"span",11),e._uU(21,"Kg \xa0"),e.qZA(),e.YNc(22,Te,2,0,"mat-error",10),e.qZA(),e.TgZ(23,"button",12),e.NdJ("click",function(){return n.handlerCreate()}),e.YNc(24,we,2,0,"span",10),e.YNc(25,Ze,1,1,"mat-progress-spinner",13),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("visible",n.open),e.xp6(2),e.Q6J("formGroup",n.newDetail),e.xp6(4),e.Q6J("ngIf",n.isGroup),e.xp6(1),e.Q6J("ngIf",n.isGroup),e.xp6(1),e.Q6J("ngIf",!n.isGroup),e.xp6(6),e.Q6J("formControlName","price"),e.xp6(1),e.Q6J("ngIf",n.newDetail.get("price").hasError("required")),e.xp6(4),e.Q6J("formControlName","weight"),e.xp6(3),e.Q6J("ngIf",n.newDetail.get("weight").hasError("required")),e.xp6(1),e.Q6J("disabled",n.newDetail.disabled),e.xp6(1),e.Q6J("ngIf",!n.newDetail.disabled),e.xp6(1),e.Q6J("ngIf",n.newDetail.disabled))},directives:[N.V,c._Y,c.JL,c.sg,B.oG,d.O5,m.KE,m.hX,m.qo,w.Nt,c.wV,c.Fj,c.JJ,c.u,m.R9,x.lW,m.TO,L.NU,q.Qc,u.jx,h.Ou],styles:[""]}),i})();var Fe=l(1769);const Ie=["contractInNgForm"];function Se(i,o){1&i&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"mat-spinner",6),e.qZA(),e.qZA()),2&i&&(e.xp6(2),e.Q6J("diameter",50)("mode","indeterminate"))}function Me(i,o){if(1&i&&(e.TgZ(0,"mat-option",26),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.Q6J("value",t),e.xp6(1),e.AsE(" ",t.numberDocument,"-",t.businessName," ")}}function Ue(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function De(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo es obligatorio*"),e.qZA())}function Ee(i,o){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo es obligatorio*"),e.qZA())}function Ne(i,o){1&i&&(e.TgZ(0,"span"),e._uU(1,"Descargar plantilla"),e.qZA())}function ke(i,o){1&i&&e._UZ(0,"mat-progress-spinner",29),2&i&&e.Q6J("diameter",25)}function qe(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"a",27),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).downloadPlantilla()}),e.YNc(2,Ne,2,0,"span",2),e.YNc(3,ke,1,1,"mat-progress-spinner",28),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",!t.loadingTemplate),e.xp6(1),e.Q6J("ngIf",t.loadingTemplate)}}function Oe(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",30),e.TgZ(1,"input",31),e.NdJ("change",function(a){return e.CHM(t),e.oxw(2).changeFile(a)}),e.qZA(),e.TgZ(2,"label",32),e.O4$(),e.TgZ(3,"svg",33),e._UZ(4,"path",34),e.qZA(),e.kcU(),e.TgZ(5,"span",35),e._uU(6),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(6),e.Oqu(""===t.nameFile?"Seleccionar archivo":t.nameFile)}}function Le(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"a",40),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).handleModalDetail(!0)}),e._uU(1,"Agregar Mae"),e.qZA()}}function Be(i,o){1&i&&(e.TgZ(0,"mat-list",41),e.TgZ(1,"mat-list-item"),e.TgZ(2,"div",42),e.TgZ(3,"h1",43),e._uU(4,"Mae"),e.qZA(),e.TgZ(5,"h1",43),e._uU(6,"Descripci\xf3n"),e.qZA(),e.TgZ(7,"h1",44),e._uU(8,"Precio"),e.qZA(),e.TgZ(9,"h1",44),e._uU(10,"Peso"),e.qZA(),e.TgZ(11,"h1",44),e._uU(12,"Balance"),e.qZA(),e.TgZ(13,"h1",44),e._uU(14,"Acci\xf3n"),e.qZA(),e.qZA(),e.qZA(),e.qZA())}function Je(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"a",40),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(3).handlerRemove(a)}),e.TgZ(2,"mat-icon"),e._uU(3,"delete"),e.qZA(),e.qZA(),e.qZA()}}function Qe(i,o){if(1&i&&(e.TgZ(0,"mat-list",41),e.TgZ(1,"mat-list-item",45),e.TgZ(2,"div",46),e.TgZ(3,"h1",47),e._uU(4),e.qZA(),e.TgZ(5,"h1",47),e._uU(6),e.qZA(),e.TgZ(7,"h1"),e._uU(8),e.qZA(),e.TgZ(9,"h1"),e._uU(10),e.qZA(),e.TgZ(11,"h1"),e._uU(12),e.qZA(),e.YNc(13,Je,4,0,"div",2),e.qZA(),e.qZA(),e._UZ(14,"p-divider"),e.qZA()),2&i){const t=o.$implicit,n=e.oxw(3);e.xp6(4),e.Oqu(t.mae),e.xp6(2),e.Oqu(t.descripcion),e.xp6(2),e.Oqu(t.price),e.xp6(2),e.Oqu(t.weight),e.xp6(2),e.Oqu(t.balance),e.xp6(1),e.Q6J("ngIf",n.isNew)}}function Pe(i,o){if(1&i&&(e.TgZ(0,"mat-card",36),e.TgZ(1,"mat-card-actions"),e.YNc(2,Le,2,0,"a",37),e.qZA(),e.YNc(3,Be,15,0,"mat-list",38),e._UZ(4,"br"),e.YNc(5,Qe,15,6,"mat-list",39),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.isNew),e.xp6(1),e.Q6J("ngIf",0!==t.auxArrShow.length),e.xp6(2),e.Q6J("ngForOf",t.auxArrShow)}}function ze(i,o){1&i&&(e.TgZ(0,"span"),e._uU(1,"Guardar"),e.qZA())}function Re(i,o){1&i&&e._UZ(0,"mat-progress-spinner",29),2&i&&e.Q6J("diameter",25)}function Ye(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).handlerCreate()}),e.YNc(1,ze,2,0,"span",2),e.YNc(2,Re,1,1,"mat-progress-spinner",28),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("disabled",t.newContracts.disabled),e.xp6(1),e.Q6J("ngIf",!t.newContracts.disabled),e.xp6(1),e.Q6J("ngIf",t.newContracts.disabled)}}const Ve=function(){return["/contrate"]};function He(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",7),e.TgZ(2,"h1",8),e._uU(3,"Agregar contrato"),e.qZA(),e._UZ(4,"p-button",9),e.qZA(),e._UZ(5,"mat-divider"),e.TgZ(6,"form",10,11),e.TgZ(8,"mat-form-field",12),e.TgZ(9,"mat-label"),e._uU(10,"Cliente"),e.qZA(),e.TgZ(11,"input",13),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().filterOptions(a)}),e.qZA(),e.TgZ(12,"mat-autocomplete",14,15),e.NdJ("optionSelected",function(a){return e.CHM(t),e.oxw().selectOption(a)}),e.YNc(14,Me,2,3,"mat-option",16),e.qZA(),e.YNc(15,Ue,2,0,"mat-error",2),e.qZA(),e.TgZ(16,"mat-form-field",12),e.TgZ(17,"mat-label"),e._uU(18,"Proceso Nro"),e.qZA(),e._UZ(19,"input",17),e.YNc(20,De,2,0,"mat-error",2),e.qZA(),e.TgZ(21,"mat-form-field",12),e.TgZ(22,"mat-label"),e._uU(23,"Duraci\xf3n"),e.qZA(),e._UZ(24,"input",18),e._UZ(25,"mat-datepicker-toggle",19),e._UZ(26,"mat-datepicker",null,20),e.YNc(28,Ee,2,0,"mat-error",2),e.qZA(),e.TgZ(29,"mat-form-field",12),e.TgZ(30,"mat-label"),e._uU(31,"Nota"),e.qZA(),e._UZ(32,"input",21),e.qZA(),e.YNc(33,qe,4,2,"div",22),e.YNc(34,Oe,7,1,"div",23),e.YNc(35,Pe,6,3,"mat-card",24),e.YNc(36,Ye,3,3,"button",25),e.qZA(),e.qZA()}if(2&i){const t=e.MAs(13),n=e.MAs(27),a=e.oxw();e.xp6(4),e.Q6J("routerLink",e.DdM(16,Ve)),e.xp6(2),e.Q6J("formGroup",a.newContracts),e.xp6(5),e.Q6J("matAutocomplete",t),e.xp6(1),e.Q6J("displayWith",a.displayFn),e.xp6(2),e.Q6J("ngForOf",a.options),e.xp6(1),e.Q6J("ngIf",a.newContracts.get("customer").hasError("required")),e.xp6(4),e.Q6J("formControlName","processNumber"),e.xp6(1),e.Q6J("ngIf",a.newContracts.get("processNumber").hasError("required")),e.xp6(4),e.Q6J("matDatepicker",n),e.xp6(1),e.Q6J("for",n),e.xp6(3),e.Q6J("ngIf",a.newContracts.get("duration").hasError("required")),e.xp6(4),e.Q6J("formControlName","notes"),e.xp6(1),e.Q6J("ngIf","PRIVADO"===a.typeClient&&!a.hasDocument),e.xp6(1),e.Q6J("ngIf","PRIVADO"===a.typeClient&&!a.hasDocument),e.xp6(1),e.Q6J("ngIf",""!==a.newContracts.get("customer").value),e.xp6(1),e.Q6J("ngIf",a.isNew&&""!==a.newContracts.get("customer").value||""!==a.idContract&&!a.hasDocument)}}let J=(()=>{class i{constructor(t,n,a,s,r){this.fromBuilder=t,this.messageService=n,this.companyService=a,this.activatedRoute=s,this.router=r,this.open=!1,this.setOpen=new e.vpe,this.loading=!0,this.options=[],this.detail=[],this.isNew=!0,this.typeClient="",this.openModalDetail=!1,this.uploadedFiles=[],this.fileSelect=[],this.nameFile="",this.idContract="",this.hasDocument=!1,this.loadingTemplate=!1,this.auxArrShow=[]}ngOnInit(){if(this.companyService.findAll(),!this.router.url.includes("edit"))return this.newContracts=this.fromBuilder.group({customer:["",c.kI.required],duration:[,c.kI.required],processNumber:["",c.kI.required],notes:[""]}),void(this.loading=!1);this.activatedRoute.params.pipe((0,pe.w)(({id:t})=>this.companyService.getContractById(t))).subscribe(t=>{const n=t.data.data.contract;this.isNew=!1,this.newContracts=this.fromBuilder.group({processNumber:[n.processNumber,c.kI.required],duration:[n.duration,c.kI.required],customer:[n.customer,c.kI.required],document:[null],notes:[null==n?void 0:n.notes]}),this.idContract=n.id,this.idCustomer=n.customer.id,this.companyService.findById(n.customer.id).subscribe(a=>{this.typeClient=a.customer.groupId.name}),this.hasDocument=n.hasDocument,this.detail=n.detail,this.auxArrShow=this.transformData(n),this.loading=!1})}transformData(t){let n=[];const a=t.detail.filter(r=>r.groupId),s=t.detail.filter(r=>!r.groupId);return a.map(r=>{if(void 0===n.find(f=>f.descripcion))n.push({mae:r.mae.name,descripcion:r.groupName,price:r.price,weight:r.weight,balance:r.balance});else{const f=n.find(I=>I.descripcion===r.groupName);void 0===f?n.push({mae:r.mae.name,descripcion:r.groupName,price:r.price,weight:r.weight,balance:r.balance}):f.mae=f.mae+","+r.mae.name}}),s.map(r=>{n.push({mae:r.mae.name,descripcion:r.mae.description,price:r.price,weight:r.weight,balance:r.balance})}),n}filterOptions(t){this.options=this.companyService.companies.filter(n=>n.numberDocument.includes(t)||n.businessName.toLowerCase().includes(t.toLowerCase()))}displayFn(t){return t&&t.numberDocument?`${t.numberDocument} - ${t.businessName}`:""}handleModalDetail(t){this.openModalDetail=t}handleData(t){if(t.mae.length>0&&void 0!==t.mae){let a,n=(0,de.Z)().toString();const s=t.mae.map(r=>({mae:r,groupName:t.groupName,groupId:n,price:t.price,weight:t.weight}));t.mae.map(r=>{a?a.mae=a.mae+" ,"+r.name:a={mae:r.name,descripcion:t.groupName,price:t.price,weight:t.weight,balance:t.balance}}),this.detail=this.detail.concat(s),this.auxArrShow=[...this.auxArrShow,a]}else this.detail=[...this.detail,t],this.auxArrShow=[...this.auxArrShow,{mae:t.mae.name,descripcion:t.mae.description,price:t.price,weight:t.weight,balance:t.balance}];this.openModalDetail=!1}selectOption(t){this.idCustomer=t.option.value.id,this.typeClient=t.option.value.groupId.name}createPublic(){this.detail.length>0?(this.newContracts.disable(),this.companyService.createContract({customer:this.newContracts.value.customer.id,duration:this.newContracts.value.duration,processNumber:this.newContracts.value.processNumber,document:"",notes:this.newContracts.value.notes}).then(n=>{this.detail.map((a,s)=>{const r={mae:a.mae.id,contract:n.data.data.createContract.id.toString()};a.price&&(r.price=parseFloat(a.price)),a.weight&&(r.weight=parseFloat(a.weight)),""!==a.groupName&&(r.groupId=a.groupId,r.groupName=a.groupName),this.companyService.createContractDetail(r).then(p=>{s===this.detail.length-1&&(this.newContracts.reset(),this.newContracts.enable(),this.messageService.add({severity:"success",detail:"Contrato creado correctamente",summary:"Transacci\xf3n existosa"}),this.router.navigate(["/contrate"]))})})}).catch(()=>{this.newContracts.enable(),this.messageService.add({severity:"error",detail:"Error al ingresar el contrato",summary:"Transacci\xf3n fallida"})})):this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Es necesario agregar un mae al menos"})}createPrivate(){this.detail.length>0?(this.newContracts.disable(),this.companyService.createContract({customer:this.newContracts.value.customer.id,duration:this.newContracts.value.duration,processNumber:this.newContracts.value.processNumber,document:"",notes:this.newContracts.value.notes}).then(n=>{this.detail.map((a,s)=>{const r={mae:a.mae.id,contract:n.data.data.createContract.id.toString()};a.price&&(r.price=parseFloat(a.price)),a.weight&&(r.weight=parseFloat(a.weight)),""!==a.groupName&&(r.groupId=a.groupId,r.groupName=a.groupName),this.companyService.createContractDetail(r).then(p=>{s===this.detail.length-1&&(0===this.fileSelect.length?(this.newContracts.reset(),this.newContracts.enable(),this.messageService.add({severity:"success",detail:"Contrato agregado correctamente",summary:"Transacci\xf3n existosa"}),this.router.navigate(["/contrate"])):this.uploadTemplate(n.data.data.createContract.id.toString()))})})}).catch(n=>{this.newContracts.enable(),this.messageService.add({severity:"error",detail:"Error al ingresar el contrato",summary:"Transacci\xf3n fallida"})})):this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Es necesario agregar un mae al menos"})}uploadTemplate(t){this.companyService.uploadFile(t,this.fileSelect).then(n=>{201===n.status&&(this.newContracts.reset(),this.newContracts.enable(),this.messageService.add({severity:"success",detail:"Contrato agregado correctamente",summary:"Transacci\xf3n existosa"}),this.router.navigate(["/contrate"]))})}handlerCreate(){if(this.newContracts.valid)if("PRIVADO"===this.typeClient)if(""===this.idContract)this.createPrivate();else{if(0===this.fileSelect.length)return void this.messageService.add({severity:"error",detail:"Para este contrato debe subir un archivo",summary:"Transacci\xf3n erronea"});this.uploadTemplate(this.idContract)}else this.createPublic()}changeFile(t){this.nameFile=0===t.target.files.length?"":t.target.files[0].name,this.fileSelect=0===t.target.files.length?[]:t.target.files[0]}downloadPlantilla(){this.loadingTemplate=!0,this.companyService.getTemplate(this.idCustomer).then(t=>{if(t.data.data){let n=`data:application/pdf;base64,${t.data.data.downloadContractTemplate}`,a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download","Plantilla-Clausula.docx"),a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),document.body.removeChild(a),this.loadingTemplate=!1}else this.messageService.add({severity:"error",detail:t.data.errors[0].message,summary:"Transacci\xf3n erronea"})})}handlerRemove(t){let n=this.detail.filter(a=>a!==t);this.detail=n}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(c.qu),e.Y36(u.ez),e.Y36(C.Q),e.Y36(_.gz),e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ie,5),2&t){let a;e.iGM(a=e.CRH())&&(n.contractInNgForm=a.first)}},inputs:{open:"open"},outputs:{setOpen:"setOpen"},features:[e._Bn([u.ez])],decls:5,vars:4,consts:[[1,"p-5","w-screen"],["class","grid justify-items-stretch",4,"ngIf"],[4,"ngIf"],[3,"open","type","setOpen","dataDetail"],[1,"grid","justify-items-stretch"],[1,"justify-self-center","pt-50"],[3,"diameter","mode"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Regresar","icon","pi pi-angle-left","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],[1,"grid","gap-4","md:grid-cols-2","sm:grid-cols-2","mt-2","bg-white","p-3",3,"formGroup"],["contractInNgForm","ngForm"],[1,"w-full","col-span-1"],["matInput","","formControlName","customer",3,"matAutocomplete","ngModelChange"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matInput","",3,"formControlName"],["matInput","","formControlName","duration",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","multiple","",3,"formControlName"],["class","w-full col-span-1",4,"ngIf"],["class","container-input",4,"ngIf"],["class","col-span-2 sm:w-full",4,"ngIf"],["mat-flat-button","","class","bg-companySecondary text-white mt-3 w-50",3,"disabled","click",4,"ngIf"],[3,"value"],["mat-flat-button","",1,"bg-companySecondary","text-white","mt-3","w-50",3,"click"],["mode","indeterminate",3,"diameter",4,"ngIf"],["mode","indeterminate",3,"diameter"],[1,"container-input"],["type","file","name","file-1","id","file-1","accept","application/pdf",1,"inputfile","inputfile-1",3,"change"],["for","file-1"],["xmlns","http://www.w3.org/2000/svg","width","20","height","17","viewBox","0 0 20 17",1,"iborrainputfile"],["d","M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"],[1,"iborrainputfile"],[1,"col-span-2","sm:w-full"],["mat-flat-button","","id","mae","color","primary",3,"click",4,"ngIf"],["class","w-full",4,"ngIf"],["class","w-full",4,"ngFor","ngForOf"],["mat-flat-button","","id","mae","color","primary",3,"click"],[1,"w-full"],[1,"grid","grid-cols-10","gap-2","w-full"],[1,"font-bold","col-span-3"],[1,"font-bold"],[1,"mb-2"],[1,"grid","grid-cols-10","gap-2","w-full","items-center","mb-5","pb-10"],[1,"col-span-3","pr-10","pt-10","h-auto"],["mat-flat-button","",1,"bg-companySecondary","text-white","mt-3","w-50",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Se,3,2,"div",1),e.YNc(2,He,37,17,"div",2),e._UZ(3,"p-toast"),e.qZA(),e.TgZ(4,"app-add-detail",3),e.NdJ("setOpen",function(s){return n.handleModalDetail(s)})("dataDetail",function(s){return n.handleData(s)}),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading),e.xp6(2),e.Q6J("open",n.openModalDetail)("type",n.typeClient))},directives:[d.O5,T.FN,Ae,h.$g,g.zx,_.rH,Fe.d,c._Y,c.JL,c.sg,m.KE,m.hX,w.Nt,c.Fj,F.ZL,c.JJ,c.u,F.XC,d.sg,b.hl,b.nW,m.R9,b.Mq,O.ey,m.TO,x.zs,h.Ou,A.a8,A.hq,Z.i$,Z.Tg,y.i,k.Hw,x.lW],styles:['.container-input[_ngcontent-%COMP%]{text-align:center;background:#fff;padding:0;border-radius:6px;width:100%;margin:0 auto 20px}.inputfile[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.inputfile[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{max-width:100%;font-size:1.25rem;font-weight:700;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;display:inline-block;overflow:hidden;padding:.625rem 1.25rem}.inputfile[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:10em;height:1em;vertical-align:middle;fill:currentColor;margin-top:-.25em;margin-right:.25em}.iborrainputfile[_ngcontent-%COMP%]{font-size:16px;font-weight:normal;font-family:"Lato"}.inputfile-1[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{color:#fff;background-color:#cbb859}.inputfile-1[_ngcontent-%COMP%]:focus + label[_ngcontent-%COMP%], .inputfile-1.has-focus[_ngcontent-%COMP%] + label[_ngcontent-%COMP%], .inputfile-1[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]:hover{background-color:#9f8465}']}),i})(),Q=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez,v.T]]}),i})(),P=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez]]}),i})(),yt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez,u.m8,g.hJ,P,Q,v.T],u.m8,g.hJ,P,Q]}),i})();const Tt=[{path:"",component:ie},{path:"add",component:J},{path:"edit/:id",component:J}];let wt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.ez,_.Bz.forChild(Tt),y.x,M.U$,D.m,T.EV,U.j,g.hJ,v.T,N.S,c.UX,ne.Iu,ae.zz,x.ot,h.Cq,k.Ps,E.AV,m.lN,w.c,Z.ie,q.WN,c.u5,oe.su,se.LD,re.Fk,b.FA,O.XK,le.rP,ce.kW,L.q4,A.QW,F.Bb,yt,B.p9]]}),i})()}}]);