"use strict";(self.webpackChunk_fuse_starter=self.webpackChunk_fuse_starter||[]).push([[4696],{4696:(X,N,l)=>{l.r(N),l.d(N,{RequestsModule:()=>Zt});var a=l(8583),b=l(6738),e=l(7716),C=l(2927),w=l(5108),p=l(8295),_=l(7441),y=l(2458),U=l(9983),c=l(3679),R=l(1095),M=l(9529),T=l(805),v=l(3423),I=l(5593),m=l(1740),q=l(7489),r=l(1795);const h=function(){return["new-request"]};function g(n,o){1&n&&e._UZ(0,"p-button",15),2&n&&e.Q6J("routerLink",e.DdM(1,h))}function A(n,o){if(1&n&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function D(n,o){if(1&n&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.name)}}function L(n,o){if(1&n&&(e.TgZ(0,"mat-option",6),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.plate),e.xp6(1),e.Oqu(t.plate)}}function S(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",16),e.TgZ(1,"span",17),e._UZ(2,"i",18),e.TgZ(3,"input",19),e.NdJ("input",function(s){return e.CHM(t),e.oxw(),e.MAs(37).filterGlobal(s.target.value,"contains")}),e.qZA(),e.qZA(),e.qZA()}}function K(n,o){if(1&n&&(e.TgZ(0,"th",21),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&n){const t=o.$implicit;e.Q6J("id",t),e.xp6(1),e.Oqu(e.lcZ(2,2,t))}}function ee(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,K,3,4,"th",20),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.headers)}}function te(n,o){1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._UZ(2,"p-skeleton"),e.qZA(),e.TgZ(3,"td"),e._UZ(4,"p-skeleton"),e.qZA(),e.TgZ(5,"td"),e._UZ(6,"p-skeleton"),e.qZA(),e.TgZ(7,"td"),e._UZ(8,"p-skeleton"),e.qZA(),e.TgZ(9,"td"),e._UZ(10,"p-skeleton"),e.qZA(),e.TgZ(11,"td"),e._UZ(12,"p-skeleton"),e.qZA(),e.qZA())}const ie=function(n){return["edit",n]};function ne(n,o){if(1&n&&e._UZ(0,"button",26),2&n){const t=e.oxw(2).$implicit;e.Q6J("routerLink",e.VKq(1,ie,t.id))}}const oe=function(n){return["preview",n]};function ae(n,o){if(1&n&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"div"),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"date"),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._UZ(15,"button",24),e.YNc(16,ne,1,3,"button",25),e.qZA(),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Tol(null==t.status?null:t.status.description),e.xp6(3),e.hij(" ",null==t.status?null:t.status.name," "),e.xp6(2),e.Oqu(null==t.customer?null:t.customer.businessName),e.xp6(2),e.Oqu(null==t?null:t.proforma),e.xp6(2),e.Oqu(e.xi3(10,11,null==t?null:t.createdAt,"d/MM/YYYY")),e.xp6(3),e.AsE("",e.xi3(13,14,null==t?null:t.withdrawalDate,"d/MM/YYYY")," ",null==t?null:t.withdrawalTime,""),e.xp6(3),e.Q6J("routerLink",e.VKq(17,oe,t.id)),e.xp6(1),e.Q6J("ngIf",i.rolLogistica||i.rolAdmin)}}function se(n,o){if(1&n&&(e.YNc(0,te,13,0,"tr",22),e.YNc(1,ae,17,19,"tr",23)),2&n){const t=e.oxw();e.Q6J("ngIf",null===t.requestAll),e.xp6(1),e.Q6J("ngIf",null!==t.requestAll)}}const re=function(){return["proforma","customer.businessName","numeroPedido"]},le=function(){return[10,20,40]};let ue=(()=>{class n{constructor(t){this._requestService=t,this.headers=["estado","raz\xf3n social","n\xb0 proforma","fecha solicitud","fecha retiro","acciones"],this.rolAdmin=!1,this.rolComercial=!1,this.rolLogistica=!1,this.statusSearch="",this.citySearch="",this.vehicleSearch="",this.plateSearch="",this.cadena="?",this.ec=b().locale("ec")}get requestAll(){return this._requestService.request?(this._requestService.request.map(t=>{t.createdAt=new Date(t.createdAt)}),this._requestService.request.sort((t,i)=>i.createdAt-t.createdAt)):null}ngOnInit(){this._requestService.getAll(),this._requestService.getVehiculo().subscribe(t=>this.vehicle=t.vehicles),this._requestService.getCatalogo("TYPEVECHICLE").subscribe(t=>this.typeVehicle=t.catalog.detailCatalog),this._requestService.getCatalogo("REQUESTSTATUS").subscribe(t=>this.statusRequest=t.catalog.detailCatalog),this.user=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):[],this.user.roles.map(t=>{"ROLE_COMMERCIAL"===t.name?this.rolComercial=!0:"ROLE_SUPERADMIN"===t.name?this.rolAdmin=!0:"ROLE_LOGISTICA"===t.name&&(this.rolLogistica=!0)})}handlerPreviewRequest(t){}selectionStatus(t){this.statusSearch=t}selectionPlate(t){this.plateSearch=t}selectionVehicle(t){this.vehicleSearch=t}searchFilters(){let t="",i="",s="",u="",d="";""!==this.statusSearch&&void 0!==this.statusSearch&&(t="status="+this.statusSearch+"&"),""!==this.citySearch&&void 0!==this.citySearch&&(s="city="+this.citySearch+"&"),""!==this.vehicleSearch&&void 0!==this.vehicleSearch&&(u="vehicle="+this.vehicleSearch+"&"),""!==this.plateSearch&&void 0!==this.plateSearch&&(d="plate="+this.plateSearch+"&"),i=t+s+u+d,this._requestService.getAllFilter(i)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-requests"]],features:[e._Bn([])],decls:42,vars:15,consts:[[1,"p-5","w-screen"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Agregar","icon","pi pi-plus","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink",4,"ngIf"],[1,"grid","grid-cols-4","gap-4","bg-white","p-3","mb-10"],[3,"selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["matInput","",3,"ngModel","ngModelChange"],["mat-flat-button","",1,"bg-companySecondary","text-bgColor",3,"color","click"],["responsiveLayout","scroll","currentPageReportTemplate","Mostrando {first} al {last} de {totalRecords} registros","scrollHeight","450px",3,"scrollable","value","paginator","globalFilterFields","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["label","Agregar","icon","pi pi-plus","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",3,"input"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[4,"ngIf"],[3,"class",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-eye",1,"p-button-rounded","p-button-outlined","p-button-success","mr-2",3,"routerLink"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","class","p-button-rounded p-button-outlined p-button-success mr-2",3,"routerLink",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-outlined","p-button-success","mr-2",3,"routerLink"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e.TgZ(2,"div",1),e.TgZ(3,"h1",2),e._uU(4,"Solicitudes previas"),e.qZA(),e.YNc(5,g,1,2,"p-button",3),e.qZA(),e._UZ(6,"p-divider"),e.TgZ(7,"div",4),e.TgZ(8,"mat-form-field"),e.TgZ(9,"mat-label"),e._uU(10,"Estado"),e.qZA(),e.TgZ(11,"mat-select",5),e.NdJ("selectionChange",function(u){return i.selectionStatus(u.value)}),e.TgZ(12,"mat-option",6),e._uU(13,"TODOS"),e.qZA(),e.YNc(14,A,2,2,"mat-option",7),e.qZA(),e.qZA(),e.TgZ(15,"mat-form-field"),e.TgZ(16,"mat-label"),e._uU(17,"Ciudad"),e.qZA(),e.TgZ(18,"input",8),e.NdJ("ngModelChange",function(u){return i.citySearch=u}),e.qZA(),e.qZA(),e.TgZ(19,"mat-form-field"),e.TgZ(20,"mat-label"),e._uU(21,"Vehiculo"),e.qZA(),e.TgZ(22,"mat-select",5),e.NdJ("selectionChange",function(u){return i.selectionVehicle(u.value)}),e.TgZ(23,"mat-option",6),e._uU(24,"TODOS"),e.qZA(),e.YNc(25,D,2,2,"mat-option",7),e.qZA(),e.qZA(),e.TgZ(26,"mat-form-field"),e.TgZ(27,"mat-label"),e._uU(28,"Placa"),e.qZA(),e.TgZ(29,"mat-select",5),e.NdJ("selectionChange",function(u){return i.selectionPlate(u.value)}),e.TgZ(30,"mat-option",6),e._uU(31,"TODOS"),e.qZA(),e.YNc(32,L,2,2,"mat-option",7),e.qZA(),e.qZA(),e.TgZ(33,"button",9),e.NdJ("click",function(){return i.searchFilters()}),e._uU(34,"Buscar"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(35,"div"),e.TgZ(36,"p-table",10,11),e.YNc(38,S,4,0,"ng-template",12),e.YNc(39,ee,2,1,"ng-template",13),e.YNc(40,se,2,2,"ng-template",14),e.qZA(),e._UZ(41,"router-outlet"),e.qZA(),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngIf",i.rolComercial||i.rolAdmin),e.xp6(9),e.Q6J("ngForOf",i.statusRequest),e.xp6(4),e.Q6J("ngModel",i.citySearch),e.xp6(7),e.Q6J("ngForOf",i.typeVehicle),e.xp6(7),e.Q6J("ngForOf",i.vehicle),e.xp6(1),e.Q6J("color","white"),e.xp6(3),e.Q6J("scrollable",null!==i.requestAll)("value",null===i.requestAll?i.headers.concat(i.headers):i.requestAll)("paginator",!0)("globalFilterFields",e.DdM(13,re))("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",e.DdM(14,le)))},directives:[a.O5,w.i,p.KE,p.hX,_.gD,y.ey,a.sg,U.Nt,c.Fj,c.JJ,c.On,R.lW,M.iA,T.jx,v.lC,I.zx,v.rH,m.o,q.O,I.Hq,r.H],pipes:[a.rS,a.uU],styles:[".blanco[_ngcontent-%COMP%]{border-left:5px solid white;margin-right:15px;height:auto}.verde[_ngcontent-%COMP%]{border-left:5px solid green;margin-right:15px;height:auto}.amarillo[_ngcontent-%COMP%]{border-left:5px solid yellow;margin-right:15px;height:auto}.rojo[_ngcontent-%COMP%]{border-left:5px solid red;margin-right:15px;height:auto}.inicial[_ngcontent-%COMP%]{border-left:5px solid white;margin-right:15px;height:auto}"]}),n})();var F=l(8239),H=l(3190),x=l(2238),ce=l(5036),Y=l(2453);function de(n,o){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"h2"),e._uU(2,"\xbfQuiere agregar una direcci\xf3n externa?"),e.qZA(),e.qZA())}function me(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().aceptar()}),e._uU(2,"Si "),e.qZA(),e.TgZ(3,"button",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().cerrar()}),e._uU(4,"No"),e.qZA(),e.qZA()}}function pe(n,o){if(1&n&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function he(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Por favor seleccione una direcci\xf3n "),e.qZA())}function ge(n,o){if(1&n&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function fe(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"form",7),e.TgZ(2,"mat-form-field"),e.TgZ(3,"mat-label"),e._uU(4,"Destinatario alterno"),e.qZA(),e.TgZ(5,"mat-select",8),e.YNc(6,pe,2,2,"mat-option",9),e.qZA(),e.YNc(7,he,2,0,"mat-error",10),e.qZA(),e.TgZ(8,"mat-form-field"),e.TgZ(9,"mat-label"),e._uU(10,"Compa\xf1ia destinataria"),e.qZA(),e.TgZ(11,"mat-select",8),e.YNc(12,ge,2,2,"mat-option",9),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(4),e.Q6J("formControlName","externalAddress"),e.xp6(1),e.Q6J("ngForOf",t.external),e.xp6(1),e.Q6J("ngIf",t.form.get("externalAddress").hasError("required")),e.xp6(4),e.Q6J("formControlName","company"),e.xp6(1),e.Q6J("ngForOf",t.destination)}}function _e(n,o){if(1&n&&(e.TgZ(0,"mat-option",11),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function qe(n,o){if(1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"form",7),e.TgZ(2,"mat-form-field"),e.TgZ(3,"mat-label"),e._uU(4,"Compa\xf1ia destinataria"),e.qZA(),e.TgZ(5,"mat-select",8),e.YNc(6,_e,2,2,"mat-option",9),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(4),e.Q6J("formControlName","company"),e.xp6(1),e.Q6J("ngForOf",t.destination)}}function ve(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveRequest()}),e._uU(2,"Generar "),e.qZA(),e.qZA()}}let Ze=(()=>{class n{constructor(t,i,s,u,d,f){this.formBuilder=t,this.data=i,this.dialogRef=s,this.externalService=u,this.requestService=d,this.messageService=f,this.confirmation=!1,this.isVisibleDirection=!1}ngOnInit(){this.data.confirmationLogistic&&(this.isVisibleDirection=!0),this.externalService.getExternal().then(t=>this.external=t.data.data.externalAddressesAll),this.externalService.getFilter(`${this.data.id}`).then(t=>{console.log(t),0===t.data.data.available.length?(this.messageService.add({severity:"warn",detail:"No existen coincidencias",summary:"Se cargaron todas las compa\xf1ias destinatarias"}),this.externalService.getCompanies().then(i=>this.destination=i.data.data.companies)):this.destination=t.data.data.available}),this.form=this.formBuilder.group({externalAddress:[""],company:[],confirmationLogistic:[!0]})}aceptar(){this.confirmation=!0}cerrar(){this.isVisibleDirection=!0}saveRequest(){this.form.invalid||this.requestService.updateRequest(this.data.id,this.confirmation?this.form.value:{company:this.form.value.company,confirmationLogistic:this.form.value.confirmationLogistic}).subscribe(t=>this.dialogRef.close("generar"))}cancel(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.qu),e.Y36(x.WI),e.Y36(x.so),e.Y36(ce.l),e.Y36(C.s),e.Y36(T.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-modal"]],features:[e._Bn([T.ez])],decls:9,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","color","blue",3,"click"],["mat-button","",3,"click"],["autocomplete","off",1,"grid","grid-cols-1","gap-2",3,"formGroup"],["name","trasport",3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Confirmaci\xf3n"),e.qZA(),e._UZ(2,"hr"),e.YNc(3,de,3,0,"div",1),e.YNc(4,me,5,0,"div",2),e.YNc(5,fe,13,6,"div",1),e.YNc(6,qe,7,3,"div",1),e.YNc(7,ve,3,0,"div",2),e._UZ(8,"p-toast")),2&t&&(e.xp6(3),e.Q6J("ngIf",!i.confirmation&&!i.isVisibleDirection),e.xp6(1),e.Q6J("ngIf",!i.confirmation&&!i.isVisibleDirection),e.xp6(1),e.Q6J("ngIf",i.confirmation),e.xp6(1),e.Q6J("ngIf",i.isVisibleDirection),e.xp6(1),e.Q6J("ngIf",i.confirmation||i.isVisibleDirection))},directives:[x.uh,a.O5,Y.FN,x.xY,x.H8,R.lW,c._Y,c.JL,c.sg,p.KE,p.hX,_.gD,c.JJ,c.u,a.sg,y.ey,p.TO],encapsulation:2}),n})();var Te=l(1256),Ae=l(7495),W=l(369),P=l(4885),z=l(1769),k=l(1554),$=l(5722),E=l(3220);const Ce=["newRequestForm"];function xe(n,o){1&n&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e._UZ(2,"mat-spinner",5),e.qZA(),e.qZA()),2&n&&(e.xp6(2),e.Q6J("diameter",50)("mode","indeterminate"))}function be(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",38),e.NdJ("onClick",function(){return e.CHM(t),e.oxw(3).openModalConfirmation()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("loading",t.downloadLoading)}}function we(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",39),e.NdJ("onClick",function(){return e.CHM(t),e.oxw(3).downloadXml()}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("loading",t.downloadLoading)}}function ye(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",34),e.TgZ(1,"p-button",35),e.NdJ("onClick",function(s){return e.CHM(t),e.oxw(2).confirm(s)}),e.qZA(),e.YNc(2,be,1,1,"p-button",36),e.YNc(3,we,1,1,"p-button",37),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("loading",t.newRequest.disabled),e.xp6(1),e.Q6J("ngIf",t.requestStatus),e.xp6(1),e.Q6J("ngIf",t.requestStatus)}}function Re(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Ie(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t),e.xp6(1),e.AsE(" ",t.numberDocument,"-",t.businessName," ")}}function Ue(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Se(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(2);e.Q6J("value",""!==i.id?t.id:t),e.xp6(1),e.Oqu(t.name)}}function Oe(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Je(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Ne(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Me(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function Pe(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function Ee(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(2);e.Q6J("value",""!==i.id?t.id:t),e.xp6(1),e.Oqu(t.processNumber)}}function Qe(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function De(n,o){if(1&n&&(e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2,"Contacto de confirmaci\xf3n"),e.qZA(),e._UZ(3,"input",41),e.YNc(4,Qe,2,0,"mat-error",2),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("formControlName","confirmation"),e.xp6(1),e.Q6J("ngIf",t.newRequest.get("confirmation").hasError("required"))}}function Le(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Fe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2,"Fecha de retiro"),e.qZA(),e.TgZ(3,"input",42),e.NdJ("dateChange",function(){return e.CHM(t),e.oxw(2).dateChange()}),e.qZA(),e._UZ(4,"mat-datepicker-toggle",43),e._UZ(5,"mat-datepicker",null,44),e.YNc(7,Le,2,0,"mat-error",2),e.qZA()}if(2&n){const t=e.MAs(6),i=e.oxw(2);e.xp6(3),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t),e.xp6(3),e.Q6J("ngIf",i.newRequest.get("withdrawalDate").hasError("required"))}}function Ye(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function ke(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2,"Hora de retiro"),e.qZA(),e.TgZ(3,"input",45),e.NdJ("change",function(){return e.CHM(t),e.oxw(2).hourChange()}),e.qZA(),e.YNc(4,Ye,2,0,"mat-error",2),e.qZA()}if(2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("formControlName","withdrawalTime"),e.xp6(1),e.Q6J("ngIf",t.newRequest.get("withdrawalTime").hasError("required"))}}function Ve(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Be(n,o){if(1&n&&(e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2,"Fecha estimada"),e.qZA(),e._UZ(3,"input",46),e._UZ(4,"mat-datepicker-toggle",43),e._UZ(5,"mat-datepicker",null,44),e.YNc(7,Ve,2,0,"mat-error",2),e.qZA()),2&n){const t=e.MAs(6),i=e.oxw(2);e.xp6(3),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t),e.xp6(3),e.Q6J("ngIf",i.newRequest.get("estimatedDate").hasError("required"))}}function je(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.plate)}}function He(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function We(n,o){if(1&n&&(e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2,"Placa Veh\xedculo"),e.qZA(),e.TgZ(3,"mat-select",47),e.YNc(4,je,2,2,"mat-option",18),e.qZA(),e.YNc(5,He,2,0,"mat-error",2),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("readonly",!t.rolComercial||!t.rolLogistica),e.xp6(1),e.Q6J("ngForOf",t.vehicleSearch),e.xp6(1),e.Q6J("ngIf",t.newRequest.get("vehicle").hasError("required"))}}function ze(n,o){if(1&n&&(e.TgZ(0,"mat-option",40),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.fullName)}}function $e(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo el obligatorio "),e.qZA())}function Ge(n,o){if(1&n&&(e.TgZ(0,"mat-form-field"),e.TgZ(1,"mat-label"),e._uU(2,"Conductor"),e.qZA(),e.TgZ(3,"mat-select",48),e.YNc(4,ze,2,2,"mat-option",18),e.qZA(),e.YNc(5,$e,2,0,"mat-error",2),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("readonly",!t.rolComercial||!t.rolLogistica),e.xp6(1),e.Q6J("ngForOf",t.drivers),e.xp6(1),e.Q6J("ngIf",t.newRequest.get("driver").hasError("required"))}}const V=function(){return{width:"100%"}},B=function(){return{color:"red"}};function Xe(n,o){if(1&n&&(e.TgZ(0,"div",14),e.TgZ(1,"mat-label"),e._uU(2,"Ayudantes"),e.qZA(),e._UZ(3,"br"),e._UZ(4,"p-multiSelect",49),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Akn(e.DdM(5,V)),e.Q6J("panelStyle",e.DdM(6,B))("options",t.helpers)("formControlName","assistants")}}function Ke(n,o){if(1&n&&(e.TgZ(0,"div",14),e.TgZ(1,"mat-label"),e._uU(2,"Herramientas y maquinarias"),e.qZA(),e._UZ(3,"br"),e._UZ(4,"p-multiSelect",50),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Akn(e.DdM(5,V)),e.Q6J("panelStyle",e.DdM(6,B))("options",t.tools)("formControlName","tools")}}function et(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-form-field",51),e.TgZ(1,"mat-label"),e._uU(2,"Novedades logistica"),e.qZA(),e.TgZ(3,"textarea",52),e.NdJ("change",function(){return e.CHM(t),e.oxw(2).newChange()}),e.qZA(),e.qZA()}2&n&&(e.xp6(3),e.Q6J("formControlName","news"))}function tt(n,o){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"El campo es obligatorio "),e.qZA())}function it(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1," Guardar "),e.qZA())}function nt(n,o){1&n&&e._UZ(0,"mat-progress-spinner",5),2&n&&e.Q6J("diameter",24)("mode","indeterminate")}const ot=function(){return["/request"]};function at(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",6),e.TgZ(2,"h1",7),e._uU(3),e.qZA(),e._UZ(4,"p-button",8),e.qZA(),e.YNc(5,ye,4,3,"div",9),e._UZ(6,"mat-divider"),e.TgZ(7,"form",10,11),e.TgZ(9,"div",12),e.TgZ(10,"mat-form-field"),e.TgZ(11,"mat-label"),e._uU(12,"Proforma N\xb0"),e.qZA(),e._UZ(13,"input",13),e.YNc(14,Re,2,0,"mat-error",2),e.qZA(),e.TgZ(15,"mat-form-field",14),e.TgZ(16,"mat-label"),e._uU(17,"Ruc"),e.qZA(),e.TgZ(18,"input",15),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().filterOptions(s)}),e.qZA(),e.TgZ(19,"mat-autocomplete",16,17),e.NdJ("optionSelected",function(s){return e.CHM(t),e.oxw().selectOption(s)}),e.YNc(21,Ie,2,3,"mat-option",18),e.qZA(),e.YNc(22,Ue,2,0,"mat-error",2),e.qZA(),e.TgZ(23,"mat-form-field"),e.TgZ(24,"mat-label"),e._uU(25,"Raz\xf3n Social"),e.qZA(),e._UZ(26,"input",19),e.qZA(),e.TgZ(27,"mat-form-field"),e.TgZ(28,"mat-label"),e._uU(29,"Solicitante"),e.qZA(),e._UZ(30,"input",20),e.qZA(),e.TgZ(31,"mat-form-field"),e.TgZ(32,"mat-label"),e._uU(33,"Sucursales"),e.qZA(),e.TgZ(34,"mat-select",21),e.NdJ("selectionChange",function(s){return e.CHM(t),e.oxw().selectionAddress(s)}),e.YNc(35,Se,2,2,"mat-option",18),e.qZA(),e.YNc(36,Oe,2,0,"mat-error",2),e.qZA(),e.TgZ(37,"mat-form-field"),e.TgZ(38,"mat-label"),e._uU(39,"Ciudad"),e.qZA(),e._UZ(40,"input",13),e.qZA(),e.TgZ(41,"mat-form-field"),e.TgZ(42,"mat-label"),e._uU(43,"Provincia"),e.qZA(),e._UZ(44,"input",13),e.qZA(),e.TgZ(45,"mat-form-field"),e.TgZ(46,"mat-label"),e._uU(47,"Cant\xf3n"),e.qZA(),e._UZ(48,"input",13),e.qZA(),e.TgZ(49,"mat-form-field"),e.TgZ(50,"mat-label"),e._uU(51,"Direcci\xf3n"),e.qZA(),e._UZ(52,"input",13),e.qZA(),e.TgZ(53,"mat-form-field"),e.TgZ(54,"mat-label"),e._uU(55,"Responsable"),e.qZA(),e._UZ(56,"input",19),e.qZA(),e.TgZ(57,"mat-form-field"),e.TgZ(58,"mat-label"),e._uU(59,"Celular de contacto"),e.qZA(),e._UZ(60,"input",19),e.qZA(),e.TgZ(61,"mat-form-field"),e.TgZ(62,"mat-label"),e._uU(63,"Email"),e.qZA(),e._UZ(64,"input",19),e.qZA(),e.TgZ(65,"mat-form-field",22),e.TgZ(66,"mat-label"),e._uU(67,"Observaciones del retiro"),e.qZA(),e._UZ(68,"input",23),e.YNc(69,Je,2,0,"mat-error",2),e.qZA(),e.TgZ(70,"div",14),e.TgZ(71,"mat-label"),e._uU(72,"Requerimientos"),e.qZA(),e._UZ(73,"br"),e._UZ(74,"p-multiSelect",24),e.YNc(75,Ne,2,0,"mat-error",2),e.qZA(),e.TgZ(76,"mat-form-field"),e.TgZ(77,"mat-label"),e._uU(78,"Veh\xedculo proformado"),e.qZA(),e.TgZ(79,"mat-select",25),e.YNc(80,Me,2,2,"mat-option",18),e.qZA(),e.qZA(),e.TgZ(81,"mat-form-field"),e.TgZ(82,"mat-label"),e._uU(83,"Tipo-peso proformado "),e.qZA(),e.TgZ(84,"mat-select",26),e.YNc(85,Pe,2,2,"mat-option",18),e.qZA(),e.qZA(),e.TgZ(86,"mat-form-field",14),e.TgZ(87,"mat-label"),e._uU(88,"Contrato"),e.qZA(),e.TgZ(89,"mat-select",27),e.NdJ("selectionChange",function(s){return e.CHM(t),e.oxw().selectionContract(s)}),e.YNc(90,Ee,2,2,"mat-option",18),e.qZA(),e.qZA(),e.YNc(91,De,5,2,"mat-form-field",2),e.YNc(92,Fe,8,3,"mat-form-field",2),e.YNc(93,ke,5,2,"mat-form-field",2),e.YNc(94,Be,8,3,"mat-form-field",2),e.YNc(95,We,6,3,"mat-form-field",2),e.YNc(96,Ge,6,3,"mat-form-field",2),e.YNc(97,Xe,5,7,"div",28),e.YNc(98,Ke,5,7,"div",28),e.TgZ(99,"div",29),e.YNc(100,et,4,1,"mat-form-field",30),e.YNc(101,tt,2,0,"mat-error",2),e.qZA(),e._UZ(102,"div",31),e.TgZ(103,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().handlerCreateRequest()}),e.YNc(104,it,2,0,"span",2),e.YNc(105,nt,1,2,"mat-progress-spinner",33),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.MAs(20),i=e.oxw();e.xp6(3),e.hij("",i.id?"Editar":"Nueva"," solicitud"),e.xp6(1),e.Q6J("routerLink",e.DdM(58,ot)),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(2),e.Q6J("formGroup",i.newRequest),e.xp6(6),e.Q6J("formControlName","proforma")("readonly",i.rolLogistica),e.xp6(1),e.Q6J("ngIf",i.newRequest.get("proforma").hasError("required")),e.xp6(4),e.Q6J("matAutocomplete",t)("readonly",i.rolLogistica),e.xp6(1),e.Q6J("displayWith",i.displayFn),e.xp6(2),e.Q6J("ngForOf",i.options),e.xp6(1),e.Q6J("ngIf",i.newRequest.get("customer").hasError("required")),e.xp6(4),e.Q6J("value",null==i.customer?null:i.customer.businessName),e.xp6(4),e.Q6J("value",i.rolComercial||i.rolAdmin&&""===i.id?null==i.user?null:i.user.fullName:i.newRequest.get("user").value.name)("readonly",i.rolAdmin),e.xp6(4),e.Q6J("disabled",0===i.addresses.length||i.rolLogistica),e.xp6(1),e.Q6J("ngForOf",i.addresses),e.xp6(1),e.Q6J("ngIf",i.newRequest.get("addressId").hasError("required")),e.xp6(4),e.Q6J("formControlName","city")("readonly",i.rolComercial),e.xp6(4),e.Q6J("formControlName","provincia")("readonly",i.rolComercial),e.xp6(4),e.Q6J("formControlName","canton")("readonly",i.rolComercial),e.xp6(4),e.Q6J("formControlName","addressBranch")("readonly",i.rolComercial),e.xp6(4),e.Q6J("value",i.info.representante),e.xp6(4),e.Q6J("value",i.info.telefono),e.xp6(4),e.Q6J("value",i.info.email),e.xp6(4),e.Q6J("readonly",i.rolLogistica),e.xp6(1),e.Q6J("ngIf",i.newRequest.get("observation").hasError("required")),e.xp6(5),e.Akn(e.DdM(59,V)),e.Q6J("panelStyle",e.DdM(60,B))("options",i.typeRequest)("formControlName","requirements")("readonly",i.rolLogistica),e.xp6(1),e.Q6J("ngIf",i.newRequest.get("requirements").hasError("required")),e.xp6(4),e.Q6J("readonly",!i.rolComercial||!i.rolLogistica),e.xp6(1),e.Q6J("ngForOf",i.capacityVehicle),e.xp6(4),e.Q6J("readonly",!i.rolComercial||!i.rolLogistica),e.xp6(1),e.Q6J("ngForOf",i.typeVehicle),e.xp6(4),e.Q6J("disabled",i.rolLogistica),e.xp6(1),e.Q6J("ngForOf",i.contracts),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(1),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&!i.isFirst),e.xp6(2),e.Q6J("ngIf",(i.rolLogistica||i.rolAdmin)&&i.showNew),e.xp6(1),e.Q6J("ngIf",i.changeTime&&""===i.newRequest.get("news").value),e.xp6(2),e.Q6J("color","primary")("disabled",i.newRequest.disabled),e.xp6(1),e.Q6J("ngIf",!i.newRequest.disabled),e.xp6(1),e.Q6J("ngIf",i.newRequest.disabled)}}let G=(()=>{class n{constructor(t,i,s,u,d,f,O,J,Q){this._ngFormBuilder=t,this.companyService=i,this._requestService=s,this.messageService=u,this.router=d,this.activatedRoute=f,this.userService=O,this.confirmationService=J,this._matDialog=Q,this.openModal=!1,this.openModalMae=!1,this.openMae=!1,this.options=[],this.optionVehicle=[],this.addresses=[],this.vehicleSearch=[],this.info={city:"",country:"",representante:"",telefono:"",email:"",canton:"",instructions:""},this.filterMaeCat=[],this.totalWeight={maeId:"",wastes:[],quantity:0,unity:"",insumos:"",requerimientos:""},this.total=0,this.unity=[],this.totalListMae=[],this.cities=["Insumo 1","Insumo 2","Insumo 3","Insumo 4","Insumo 5"],this.waste="",this.detaailMae=[],this.loading=!0,this.id="",this.rolAdmin=!1,this.rolComercial=!1,this.rolLogistica=!1,this.capacityVehicle=[],this.typeVehicle=[],this.weightVehicle=[],this.typeRequest=[],this.statusRequest=[],this.machine=[],this.tools=[],this.contracts=[],this.openInsumo=!1,this.detailInsumos=[],this.oneInsumo={instrument:{},quantity:0},this.changeTime=!1,this.showNew=!1,this.requestStatus=!1,this.downloadLoading=!1,this.isFirst=!0,this.contractMae=[]}get instruments(){return this._requestService.instrument}ngOnInit(){if(this.user=JSON.parse(localStorage.getItem("user")),this.user.roles.map(t=>{"ROLE_COMMERCIAL"===t.name?this.rolComercial=!0:"ROLE_SUPERADMIN"===t.name?this.rolAdmin=!0:"ROLE_LOGISTICA"===t.name&&(this.rolLogistica=!0)}),this.companyService.findAll(),this._requestService.getCatalogMae(),this._requestService.getAllInstruments(),this._requestService.getCatalogo("CAPACITYVEHICLE").subscribe(t=>this.capacityVehicle=t.catalog.detailCatalog),this._requestService.getCatalogo("TYPEVECHICLE").subscribe(t=>this.typeVehicle=t.catalog.detailCatalog),this._requestService.getCatalogo("UNITYWEIGHT").subscribe(t=>this.unity=t.catalog.detailCatalog),this._requestService.getCatalogo("TYPEREQUEST").subscribe(t=>this.typeRequest=t.catalog.detailCatalog),this._requestService.getCatalogo("REQUESTSTATUS").subscribe(t=>this.statusRequest=t.catalog.detailCatalog),this._requestService.getCatalogo("TOOLS").subscribe(t=>this.tools=t.catalog.detailCatalog),!this.router.url.includes("edit"))return this.loading=!1,void(this.newRequest=this._ngFormBuilder.group({customer:["",c.kI.required],proforma:["",c.kI.required],addressId:["",c.kI.required],withdrawalTime:[""],withdrawalDate:[""],weight:[""],capacityVehicle:[""],typeVehicle:[""],observation:["",c.kI.required],instruments:[],news:[""],maeId:[""],wastes:[""],requirements:[,[c.kI.required]],status:[""],confirmation:[""],assistants:[""],unity:[""],city:[""],provincia:[""],canton:[""],addressBranch:[""],tools:[],machinery:[],estimatedDate:[""],contract:[""]}));this._requestService.getVehiculo().subscribe(t=>{this.vehicleSearch=t.vehicles},t=>{this.vehicleSearch=[]}),this._requestService.getDrivers().subscribe(t=>{this.drivers=t.drivers.filter(i=>"CONDUCTOR"===i.type.name),this.helpers=t.drivers.filter(i=>"AYUDANTE"===i.type.name)}),this.getRequest()}getRequest(){this.isFirst=!1,this.activatedRoute.params.pipe((0,H.w)(({id:t})=>this._requestService.getById(t))).subscribe(t=>{var i,s,u,d,f,O,J;this.requestData=t.request,this.newRequest=this._ngFormBuilder.group({customer:[t.request.customer,c.kI.required],proforma:[t.request.proforma,c.kI.required],user:[t.request.user],addressId:[t.request.addressId.id,c.kI.required],withdrawalTime:[t.request.withdrawalTime,c.kI.required],withdrawalDate:[t.request.withdrawalDate,c.kI.required],capacityVehicle:[t.request.capacityVehicle.id],typeVehicle:[t.request.typeVehicle.id],observation:[t.request.observation,c.kI.required],news:[t.request.news],maeId:[""],wastes:[""],requirements:[t.request.requirements,[c.kI.required]],status:[t.request.status.id],confirmation:[t.request.confirmation,c.kI.required],vehicle:[null===(i=t.request.vehicle)||void 0===i?void 0:i.id,c.kI.required],driver:[null===(s=t.request.driver)||void 0===s?void 0:s.id,c.kI.required],assistants:[t.request.assistants],unity:[t.request.unity],city:[t.request.city?t.request.city[0].toUpperCase()+t.request.city.substring(1):t.request.addressId.city[0].toUpperCase()+t.request.addressId.city.substring(1)],provincia:[t.request.provincia?t.request.provincia[0].toUpperCase()+t.request.provincia.substring(1):t.request.addressId.province[0].toUpperCase()+t.request.addressId.province.substring(1)],canton:[t.request.canton?t.request.canton[0].toUpperCase()+t.request.canton.substring(1):t.request.addressId.canton[0].toUpperCase()+t.request.addressId.canton],addressBranch:[t.request.addressBranch?t.request.addressBranch:t.request.addressId.instructions],tools:[null===(u=t.request)||void 0===u?void 0:u.tools],machinery:[null===(d=t.request)||void 0===d?void 0:d.machinery],estimatedDate:[null===(f=t.request)||void 0===f?void 0:f.estimatedDate],contract:[null===(J=null===(O=t.request)||void 0===O?void 0:O.contract)||void 0===J?void 0:J.id]}),this.optionVehicle=t.request.vehicle,this.customer=t.request.customer,this._requestService.getContract(t.request.customer.id).then(Z=>{this.contracts=Z.data.data.contracts}),this.info={city:t.request.addressId.city,country:t.request.addressId.province,representante:t.request.addressId.representative,telefono:t.request.addressId.phone,email:t.request.addressId.email,canton:t.request.addressId.canton,instructions:t.request.addressId.instructions},this.addresses=t.request.customer.addresses;const Q=[];console.log(t.request),null!==t.request.contract&&""!==t.request.contract&&(this.filterMaeCat=t.request.contract.detail.map(Z=>Z.mae)),t.request.detail.map(Z=>{const Tt={id:Z.id,maeId:Z.maeId,wastes:Z.wastes,wasteShow:Z.maeId.description,weight:Z.weight,unidad:t.request.unity?t.request.unity:"KG"};this.total+=+Z.weight,Q.push(Tt),this.detaailMae=Q}),this.detailInsumos=t.request.instruments,this.loading=!1,this.id=t.request.id,"REPROGRAMADO"===t.request.status.name&&(this.showNew=!0),("REPROGRAMADO"===t.request.status.name||"PROGRAMADO"===t.request.status.name)&&(this.requestStatus=!0)},()=>this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Error al cargar la informaci\xf3n"}))}filterOptions(t){this.options=this.companyService.companies.filter(i=>i.numberDocument.includes(t)||i.businessName.toLowerCase().includes(t.toLowerCase()))}openModalConfirmation(){this.requestData.company?this.downloadManifest():this._matDialog.open(Ze,{width:"600px",data:this.requestData}).afterClosed().subscribe(i=>{"no"===i&&(this.downloadManifest(),this.getRequest()),"generar"===i&&(this.downloadManifest(),this.getRequest())})}filterOptionMae(t){this.filterMaeCat=this.newRequest.value.contract&&""!==this.newRequest.value.contract?this.contractMae:this._requestService.maeCatalog.filter(i=>i.name.toLowerCase().includes(t.toString().toLowerCase()))}saveInsumos(t){this.detailInsumos.length>0?this.detailInsumos.map((i,s)=>{if(i.id)this.detailInsumos.length-1===s&&(this.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se agrego de manera correcta la solicitud"}),setTimeout(()=>{this.newRequest.reset(),this.router.navigate(["/request"])},1e3));else{const u={instrument:i.instrument.id,quantity:parseInt(i.quantity),request:t};this._requestService.createInsumos(u).then(d=>{this.detailInsumos.length-1===s&&(this.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se agrego de manera correcta la solicitud"}),this.newRequest.reset(),this.router.navigate(["/request"]))}).catch(d=>{this.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se agrego de manera correcta la solicitud"})})}}):(this.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se agrego de manera correcta la solicitud"}),this.newRequest.reset(),this.router.navigate(["/request"]))}handlerCreateRequest(){var t=this;if(!this.newRequest.valid)return void this.messageService.add({severity:"error",detail:"",summary:"Ingrese toda la informaci\xf3n requerida"});if(this.changeTime)return void this.messageService.add({severity:"error",detail:"",summary:"Ingrese novedades"});let i;this.newRequest.disable();const s=[];this.newRequest.get("requirements").value.map(u=>{s.push({id:u.id})}),this.newRequest.controls.requirements.setValue(s),""===this.id&&(i=this.statusRequest.filter(u=>"SOLICITADO"===u.name)),""===this.id?this._requestService.createRequest({customer:this.newRequest.value.customer.id,addressId:this.newRequest.value.addressId.id,proforma:this.newRequest.value.proforma,requirements:this.newRequest.value.requirements,user:{id:this.user.id},capacityVehicle:this.newRequest.value.capacityVehicle,typeVehicle:this.newRequest.value.typeVehicle,observation:this.newRequest.value.observation,news:this.newRequest.value.news,status:i[0].id,unity:"2a988cbd-c53e-44e1-8deb-b9c5451fd4db",city:this.newRequest.value.city,canton:this.newRequest.value.canton,provincia:this.newRequest.value.provincia,addressBranch:this.newRequest.value.addressBranch,contract:""===this.newRequest.value.contract?null:this.newRequest.value.contract.id}).subscribe(function(){var d=(0,F.Z)(function*(f){t.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se agrego de manera correcta la solicitud"}),t.newRequest.reset(),t.router.navigate(["/request"])});return function(f){return d.apply(this,arguments)}}(),d=>{d.error.error.toString().includes("QueryFailedError"),this.newRequest.enable(),this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Error al gaurdar la solicitud"})}):(null!==this.newRequest.value.withdrawalDate&&null===this.requestData.withdrawalDate&&(i=this.statusRequest.filter(d=>"PROGRAMADO"===d.name)),"SOLICITADO"===this.requestData.status.name&&null!==this.newRequest.value.withdrawalDate&&""!==this.newRequest.value.withdrawalTime&&(i=this.statusRequest.filter(d=>"PROGRAMADO"===d.name)),(null!==this.requestData.withdrawalDate&&(this.newRequest.value.withdrawalDate!==this.requestData.withdrawalDate||this.newRequest.value.withdrawalTime!==this.requestData.withdrawalTime)&&"PROGRAMADO"===this.requestData.status.name||"REPROGRAMADO"===this.requestData.status.name)&&(i=this.statusRequest.filter(d=>"REPROGRAMADO"===d.name)),this._requestService.updateRequest(this.id,{weight:this.newRequest.value.weight,capacityVehicle:this.newRequest.value.capacityVehicle,typeVehicle:this.newRequest.value.typeVehicle,withdrawalTime:this.newRequest.value.withdrawalTime,withdrawalDate:this.newRequest.value.withdrawalDate,status:void 0!==i?i[0].id:this.newRequest.value.status,confirmation:this.newRequest.value.confirmation,news:this.newRequest.value.news,vehicle:this.newRequest.value.vehicle,assistants:this.newRequest.value.assistants,driver:this.newRequest.value.driver,city:this.newRequest.value.city,canton:this.newRequest.value.canton,provincia:this.newRequest.value.provincia,addressBranch:this.newRequest.value.addressBranch,machinery:this.newRequest.value.machinery,tools:this.newRequest.value.tools,estimatedDate:this.newRequest.value.estimatedDate}).subscribe(function(){var d=(0,F.Z)(function*(f){t.newRequest.reset(),t.newRequest.enable(),t.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se edito de manera correcta la solicitud"}),t.router.navigate(["/request"])});return function(f){return d.apply(this,arguments)}}(),d=>{d.error.error.toString().includes("QueryFailedError"),this.newRequest.enable(),this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Error al editar la solicitud"})}))}displayFn(t){return t&&t.numberDocument?t.numberDocument:""}displayFnPlate(t){return t&&t.plate?t.plate:""}displayFnMae(t){return t&&t.name?t.name:""}displayFnWaste(t){return t&&t.name?t.name:""}selectOption(t){this.newRequest.controls.contract.setValue(""),this.typeClient=t.option.value.groupId.name,this.addresses=t.option.value.addresses,this.customer=t.option.value,this._requestService.getContract(t.option.value.id).then(i=>this.contracts=i.data.data.contracts)}selectOptionMae(t){this.totalWeight.maeId=t.option.value.id,this.maeInfo=t.option.value}selectOptionWaste(t){}selectionAddress(t){this.newRequest.controls.city.setValue(t.value.city[0].toUpperCase()+t.value.city.substring(1)),this.newRequest.controls.provincia.setValue(t.value.province[0].toUpperCase()+t.value.province.substring(1)),this.newRequest.controls.canton.setValue(t.value.canton[0].toUpperCase()+t.value.canton.substring(1)),this.newRequest.controls.addressBranch.setValue(t.value.instructions),this.info={city:t.value.city[0].toUpperCase()+t.value.city.substring(1),country:t.value.province[0].toUpperCase()+t.value.province.substring(1),representante:t.value.representative,telefono:t.value.phone,email:t.value.email,canton:t.value.canton[0].toUpperCase()+t.value.canton.substring(1),instructions:t.value.instructions}}selectionUnity(t){this.totalWeight.unity=t.value}selectionContract(t){this.detaailMae=[],this.total=0,this.detailContract=t.value.detail,this.contractMae=t.value.detail.map(i=>i.mae),this.filterMaeCat=t.value.detail.map(i=>i.mae)}handleShowMae(){this.openMae=!0}handlerAddMae(){if("P\xdaBLICO"===this.typeClient&&""!==this.newRequest.value.contract){const s=this.detailContract.find(u=>u.mae===this.maeInfo);if(this.totalWeight.quantity>s.balance)return void this.messageService.add({severity:"error",detail:`El peso ingresado sobrepasa el contratado, por favor ingrese un peso menor o igual a ${s.balance}`,summary:"Error al agregar mae"})}if("PRIVADO"===this.typeClient&&""!==this.newRequest.value.contract){const s=this.detailContract.find(u=>u.mae===this.maeInfo);if(this.totalWeight.quantity>s.balance)return void this.messageService.add({severity:"error",detail:`El peso ingresado sobrepasa el contratado, por favor ingrese un peso menor o igual a ${s.balance}`,summary:"Error al agregar mae"})}const t={maeId:this.newRequest.get("maeId").value,wastes:[],wasteShow:this.maeInfo.description,weight:this.totalWeight.quantity,unidad:this.totalWeight.unity};this.total+=+this.totalWeight.quantity;const i=this.detaailMae;i.push(t),this.detaailMae=i,this.totalWeight.wastes=this.waste,this.totalListMae.push(this.totalWeight),this.openMae=!1,this.newRequest.controls.maeId.setValue(""),this.newRequest.controls.wastes.setValue(""),this.maeInfo=null,this.totalWeight.unity="",this.totalWeight.quantity=0}handleChangeMae(t,i){this.totalWeight[t]=i.target.value}handleChangeInsumo(t,i){this.oneInsumo[t]=i.target.value}handleCancel(){this.openMae=!1,this.newRequest.controls.maeId.setValue(""),this.newRequest.controls.wastes.setValue(""),this.maeInfo=null,this.totalWeight.unity="",this.totalWeight.quantity=0}handlerRemove(t){const i=this.detaailMae.filter(s=>s!==t);this.total+=-t.weight,this.detaailMae=i}handleRemoveInsumos(t){const i=this.detailInsumos.filter(s=>s!==t);this.detailInsumos=i}handleOpenInsumos(){this.openInsumo=!0}handleCancelInsumos(){this.openInsumo=!1}handlerAddInsumo(){if(0===Object.entries(this.oneInsumo.instrument).length||0===this.oneInsumo.quantity)this.messageService.add({severity:"error",detail:"Complete los campos",summary:"Por favor complete los campos"});else{const t=this.detailInsumos;t.push(this.oneInsumo),this.detailInsumos=t,this.oneInsumo={instrument:{},quantity:0},this.openInsumo=!1}}confirm(t){var i=this;this.confirmationService.confirm({target:t.target,message:"\xbfEstas seguro de cancelar esta solicitud?",icon:"pi pi-exclamation-triangle",acceptLabel:"Si, Estoy seguro.",rejectLabel:"No",accept:()=>{this.newRequest.disable();const u={status:this.statusRequest.filter(d=>"NO EJECUTADO"===d.name)[0].id};this._requestService.updateRequest(this.id,u).subscribe(function(){var d=(0,F.Z)(function*(f){i.messageService.add({severity:"success",detail:"Transacci\xf3n \xe9xitosa",summary:"Se cancelo de manera correcta la solicitud"}),setTimeout(()=>{i.newRequest.enable(),i.router.navigate(["/request"])},1e3)});return function(f){return d.apply(this,arguments)}}(),d=>{d.error.error.toString().includes("QueryFailedError"),this.newRequest.enable(),this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Error al cancelar la solicitud"})})}})}hourChange(){null!==this.requestData.withdrawalTime&&"PROGRAMADO"===this.requestData.status.name&&(this.changeTime=!0,this.showNew=!0)}dateChange(){this.requestData.withdrawalDate!==this.newRequest.value.withdrawalDate&&null!==this.requestData.withdrawalTime&&"PROGRAMADO"===this.requestData.status.name&&(this.changeTime=!0,this.showNew=!0)}newChange(){this.changeTime=""===this.newRequest.value.news}downloadManifest(){this.downloadLoading=!0,this._requestService.getManifest(this.id).subscribe(t=>{const i=`${t.data}`,s=document.createElement("a");s.setAttribute("href",i),s.setAttribute("download",`Manifiesto-${this.id}.pdf`),s.setAttribute("target","_blank"),document.body.appendChild(s),s.click(),document.body.removeChild(s),this.downloadLoading=!1},t=>{this.downloadLoading=!1,this.messageService.add({severity:"error",detail:"Transacci\xf3n fallida",summary:"Error al descargar el manifiesto, pongase en contaco con soporte"})})}downloadXml(){this.downloadLoading=!0,this._requestService.getXml(this.id).subscribe(t=>{const i=`data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,${t.data}`,s=document.createElement("a");s.setAttribute("href",i),s.setAttribute("download",`${t.name}`),s.setAttribute("target","_blank"),document.body.appendChild(s),s.click(),document.body.removeChild(s),this.downloadLoading=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.qu),e.Y36(Te.Q),e.Y36(C.s),e.Y36(T.ez),e.Y36(v.F0),e.Y36(v.gz),e.Y36(Ae.K),e.Y36(T.YP),e.Y36(x.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-pages"]],viewQuery:function(t,i){if(1&t&&e.Gf(Ce,5),2&t){let s;e.iGM(s=e.CRH())&&(i.newRequestForm=s.first)}},features:[e._Bn([T.ez,T.YP])],decls:5,vars:2,consts:[[1,"p-3","w-screen"],["class","grid justify-items-stretch",4,"ngIf"],[4,"ngIf"],[1,"grid","justify-items-stretch"],[1,"justify-self-center","pt-50"],[3,"diameter","mode"],[1,"flex","justify-between","mb-2"],[1,"text-3xl","font-bold"],["label","Regresar","icon","pi pi-angle-left","styleClass","p-button-sm p-button-rounded bg-companySecondary border-white w-50",3,"routerLink"],["class","mb-5 flex flex-row-reverse",4,"ngIf"],["autocomplete","off",1,"",3,"formGroup"],["newRequestForm","ngForm"],[1,"grid","grid-cols-4","gap-4","bg-white","p-3"],["matInput","",3,"formControlName","readonly"],[1,"col-span-2"],["matInput","","formControlName","customer",3,"matAutocomplete","readonly","ngModelChange"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matInput","","readonly","",3,"value"],["matInput","",3,"value","readonly"],["formControlName","addressId",3,"disabled","selectionChange"],[1,"col-span-3"],["matInput","","formControlName","observation",3,"readonly"],["label","Requerimientos","optionLabel","name",3,"panelStyle","options","formControlName","readonly"],["formControlName","capacityVehicle",3,"readonly"],["formControlName","typeVehicle",3,"readonly"],["formControlName","contract",3,"disabled","selectionChange"],["class","col-span-2 ",4,"ngIf"],[1,"grid","grid-cols-1","col-span-2"],["class","",4,"ngIf"],[1,"col-span-4"],["mat-flat-button","","id","submit",1,"bg-companySecondary",3,"color","disabled","click"],[3,"diameter","mode",4,"ngIf"],[1,"mb-5","flex","flex-row-reverse"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-sm p-button-rounded p-button-danger border-white w-50",3,"loading","onClick"],["label","Manifiesto","icon","pi pi-cloud-download","styleClass","p-button-sm p-button-rounded .p-button-info border-white w-50",3,"loading","onClick",4,"ngIf"],["label","XML","icon","pi pi-cloud-download","styleClass","p-button-sm p-button-rounded .p-button-info border-white w-50",3,"loading","onClick",4,"ngIf"],["label","Manifiesto","icon","pi pi-cloud-download","styleClass","p-button-sm p-button-rounded .p-button-info border-white w-50",3,"loading","onClick"],["label","XML","icon","pi pi-cloud-download","styleClass","p-button-sm p-button-rounded .p-button-info border-white w-50",3,"loading","onClick"],[3,"value"],["matInput","",3,"formControlName"],["matInput","","formControlName","withdrawalDate",3,"matDatepicker","dateChange"],["matSuffix","",3,"for"],["picker",""],["type","time","matInput","",3,"formControlName","change"],["matInput","","formControlName","estimatedDate",3,"matDatepicker"],["formControlName","vehicle",3,"readonly"],["formControlName","driver",3,"readonly"],["label","Ayudantes","optionLabel","fullName",3,"panelStyle","options","formControlName"],["label","Ayudantes","optionLabel","name",3,"panelStyle","options","formControlName"],[1,""],["matInput","",3,"formControlName","change"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,xe,3,2,"div",1),e.YNc(2,at,106,61,"div",2),e._UZ(3,"p-toast"),e._UZ(4,"p-confirmPopup"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},directives:[a.O5,Y.FN,W.P,P.$g,I.zx,v.rH,z.d,c._Y,c.JL,c.sg,p.KE,p.hX,U.Nt,c.Fj,c.JJ,c.u,k.ZL,k.XC,a.sg,_.gD,$.NU,R.lW,p.TO,y.ey,E.hl,E.nW,p.R9,E.Mq,P.Ou],styles:[".multi[_ngcontent-%COMP%]{background:red;width:100%}"]}),n})();var st=l(6627),rt=l(585),j=l(6457),lt=l(2177),ut=l(1512),ct=l(2665),dt=l(3631);function mt(n,o){1&n&&(e.TgZ(0,"div",2),e._UZ(1,"mat-progress-spinner",3),e.TgZ(2,"h1",4),e._uU(3,"Cargando, porfavor espere."),e.qZA(),e.qZA()),2&n&&(e.xp6(1),e.Q6J("diameter",50)("mode","indeterminate"))}function pt(n,o){if(1&n&&(e.TgZ(0,"h1"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("-",t.instrument.name," ",t.quantity,"")}}function ht(n,o){if(1&n&&(e.TgZ(0,"h1"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij("-",t.name,"")}}function gt(n,o){if(1&n&&(e.TgZ(0,"div",11),e.TgZ(1,"h1",12),e._uU(2,"C\xf3digo:"),e.qZA(),e.TgZ(3,"h1"),e._uU(4),e.qZA(),e.TgZ(5,"h1",12),e._uU(6,"Descripci\xf3n:"),e.qZA(),e.TgZ(7,"h1"),e._uU(8),e.qZA(),e.TgZ(9,"h1",12),e._uU(10,"Tipo de tratamiento:"),e.qZA(),e.TgZ(11,"h1"),e._uU(12),e.qZA(),e.TgZ(13,"h1",12),e._uU(14,"Cantidad"),e.qZA(),e.TgZ(15,"div",14),e.TgZ(16,"h1"),e._uU(17),e.qZA(),e.qZA(),e._UZ(18,"p-divider"),e.qZA()),2&n){const t=o.$implicit;e.xp6(4),e.Oqu(t.maeId.name),e.xp6(4),e.Oqu(t.maeId.description),e.xp6(4),e.Oqu(t.maeId.treatment),e.xp6(5),e.Oqu(t.weight)}}function ft(n,o){if(1&n&&(e.TgZ(0,"div",5),e.TgZ(1,"div",6),e.TgZ(2,"h1",7),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",8),e.TgZ(5,"div",9),e.TgZ(6,"div"),e.TgZ(7,"h1",10),e._uU(8,"Solicitud"),e.qZA(),e._UZ(9,"p-divider"),e.qZA(),e.TgZ(10,"div",11),e.TgZ(11,"h1",12),e._uU(12,"Raz\xf3n social:"),e.qZA(),e.TgZ(13,"h1"),e._uU(14),e.qZA(),e.TgZ(15,"h1",12),e._uU(16,"Proforma:"),e.qZA(),e.TgZ(17,"h1"),e._uU(18),e.qZA(),e.TgZ(19,"h1",12),e._uU(20,"Fecha creada:"),e.qZA(),e.TgZ(21,"h1"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.TgZ(24,"h1",12),e._uU(25,"Fecha retiro:"),e.qZA(),e.TgZ(26,"h1"),e._uU(27),e.ALo(28,"date"),e.qZA(),e.TgZ(29,"h1",12),e._uU(30,"Peso total del retiro:"),e.qZA(),e.TgZ(31,"h1"),e._uU(32),e.qZA(),e.TgZ(33,"h1",12),e._uU(34,"Unidad"),e.qZA(),e.TgZ(35,"h1"),e._uU(36),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",9),e.TgZ(38,"div"),e.TgZ(39,"h1",10),e._uU(40,"Veh\xedculo"),e.qZA(),e._UZ(41,"p-divider"),e.qZA(),e.TgZ(42,"div",11),e.TgZ(43,"h1",12),e._uU(44,"Conductor:"),e.qZA(),e.TgZ(45,"h1"),e._uU(46),e.qZA(),e.TgZ(47,"h1",12),e._uU(48,"Veh\xedculo proformado:"),e.qZA(),e.TgZ(49,"h1"),e._uU(50),e.qZA(),e.TgZ(51,"h1",12),e._uU(52,"Tipo-peso proformado:"),e.qZA(),e.TgZ(53,"h1"),e._uU(54),e.qZA(),e.TgZ(55,"h1",12),e._uU(56,"Placa:"),e.qZA(),e.TgZ(57,"h1"),e._uU(58),e.qZA(),e.qZA(),e.qZA(),e.TgZ(59,"div",9),e.TgZ(60,"div"),e.TgZ(61,"h1",10),e._uU(62,"Cliente"),e.qZA(),e._UZ(63,"p-divider"),e.qZA(),e.TgZ(64,"div",11),e.TgZ(65,"h1",12),e._uU(66,"Provincia:"),e.qZA(),e.TgZ(67,"h1"),e._uU(68),e.qZA(),e.TgZ(69,"h1",12),e._uU(70,"Ciuddad:"),e.qZA(),e.TgZ(71,"h1"),e._uU(72),e.qZA(),e.TgZ(73,"h1",12),e._uU(74,"Canton:"),e.qZA(),e.TgZ(75,"h1"),e._uU(76),e.qZA(),e.TgZ(77,"h1",12),e._uU(78,"Celular de contacto:"),e.qZA(),e.TgZ(79,"h1"),e._uU(80),e.qZA(),e.TgZ(81,"h1",12),e._uU(82,"Contacto:"),e.qZA(),e.TgZ(83,"h1"),e._uU(84),e.qZA(),e.TgZ(85,"h1",12),e._uU(86,"Confirmaci\xf3n de retiro:"),e.qZA(),e.TgZ(87,"h1"),e._uU(88),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(89,"div",13),e.TgZ(90,"div",9),e.TgZ(91,"div"),e.TgZ(92,"h1",10),e._uU(93,"Informaci\xf3n de retiro"),e.qZA(),e._UZ(94,"p-divider"),e.qZA(),e.TgZ(95,"div",11),e.TgZ(96,"h1",12),e._uU(97,"Solicitante:"),e.qZA(),e.TgZ(98,"h1"),e._uU(99),e.qZA(),e.TgZ(100,"h1",12),e._uU(101,"Hora de retiro:"),e.qZA(),e.TgZ(102,"h1"),e._uU(103),e.qZA(),e.TgZ(104,"h1",12),e._uU(105,"Fecha de retiro:"),e.qZA(),e.TgZ(106,"h1"),e._uU(107),e.ALo(108,"date"),e.qZA(),e.TgZ(109,"h1",12),e._uU(110,"Insumos:"),e.qZA(),e.TgZ(111,"div",14),e.YNc(112,pt,2,2,"h1",15),e.qZA(),e.TgZ(113,"h1",12),e._uU(114,"Requerimientos:"),e.qZA(),e.TgZ(115,"div",14),e.YNc(116,ht,2,1,"h1",15),e.qZA(),e.TgZ(117,"h1",12),e._uU(118,"Observaciones del retiro:"),e.qZA(),e.TgZ(119,"h1"),e._uU(120),e.qZA(),e.TgZ(121,"h1",12),e._uU(122,"Novedades logistica:"),e.qZA(),e.TgZ(123,"h1"),e._uU(124),e.qZA(),e.TgZ(125,"h1",12),e._uU(126,"Direccion:"),e.qZA(),e.TgZ(127,"h1"),e._uU(128),e.qZA(),e.TgZ(129,"h1",12),e._uU(130,"Direcci\xf3n de retiro:"),e.qZA(),e.TgZ(131,"agm-map",16),e._UZ(132,"agm-marker",17),e.qZA(),e.qZA(),e.qZA(),e.TgZ(133,"div",9),e.TgZ(134,"div"),e.TgZ(135,"h1",10),e._uU(136,"Informacion Adicional"),e.qZA(),e._UZ(137,"p-divider"),e.qZA(),e.YNc(138,gt,19,4,"div",18),e.qZA(),e.qZA(),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.hij(" Solicitud N\xb0",t.request.id,""),e.xp6(11),e.Oqu(t.request.customer.businessName),e.xp6(4),e.hij("#",t.request.proforma,""),e.xp6(4),e.Oqu(e.xi3(23,31,t.request.createdAt,"shortDate")),e.xp6(5),e.Oqu(e.xi3(28,34,t.request.withdrawalDate,"shortDate")),e.xp6(5),e.Oqu(t.sumTotal),e.xp6(4),e.Oqu(null==t.request.unity?null:t.request.unity.name),e.xp6(10),e.Oqu(null==t.request.vehicle||null==t.request.vehicle.driver?null:t.request.vehicle.driver.fullName),e.xp6(4),e.Oqu(t.request.capacityVehicle.name),e.xp6(4),e.Oqu(t.request.typeVehicle.name),e.xp6(4),e.Oqu(null==t.request||null==t.request.vehicle?null:t.request.vehicle.plate),e.xp6(10),e.Oqu(t.request.addressId.province),e.xp6(4),e.Oqu(null==t.request.addressId?null:t.request.addressId.city),e.xp6(4),e.Oqu(null==t.request.addressId?null:t.request.addressId.canton),e.xp6(4),e.Oqu(t.request.addressId.phone),e.xp6(4),e.Oqu(t.request.addressId.representative),e.xp6(4),e.Oqu(t.request.confirmation),e.xp6(11),e.Oqu(t.request.user.fullName),e.xp6(4),e.Oqu(t.request.withdrawalTime),e.xp6(4),e.Oqu(e.xi3(108,37,t.request.withdrawalDate,"shortDate")),e.xp6(5),e.Q6J("ngForOf",t.request.instruments),e.xp6(4),e.Q6J("ngForOf",t.request.requirements),e.xp6(4),e.Oqu(t.request.observation),e.xp6(4),e.hij(" ",t.request.news,""),e.xp6(4),e.hij(" ",t.request.addressId.instructions,""),e.xp6(3),e.Q6J("latitude",t.lat)("longitude",t.long)("zoom",12),e.xp6(1),e.Q6J("latitude",t.lat)("longitude",t.long),e.xp6(6),e.Q6J("ngForOf",t.request.detail)}}let _t=(()=>{class n{constructor(t,i,s){this._serviceRequest=t,this._router=i,this.activatedRoute=s,this.request=[],this.loading=!0,this.sumTotal=0}ngOnInit(){this.activatedRoute.params.pipe((0,H.w)(({id:t})=>this._serviceRequest.getById(t))).subscribe(t=>{const i=t.request.addressId.coords.split(",");this.lat=parseFloat(i[0]),this.long=parseFloat(i[1]),t.request.detail.map(s=>this.sumTotal=this.sumTotal+s.weight),this.request=t.request,this.loading=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.s),e.Y36(v.F0),e.Y36(v.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-preview-request"]],decls:2,vars:2,consts:[["class","w-full flex flex-col justify-center items-center",4,"ngIf"],["class","p-5 w-full",4,"ngIf"],[1,"w-full","flex","flex-col","justify-center","items-center"],[3,"diameter","mode"],[1,"mt-1","font-bold"],[1,"p-5","w-full"],[1,"w-full","bg-white","p-3","rounded"],[1,"text-3xl","font-bold"],[1,"grid","grid-cols-3","mt-3","gap-4"],[1,"p-3","rounded","bg-white","shadow-2xl"],[1,"font-bold","text-lg"],[1,"grid","grid-cols-2","gap-3","mt-3"],[1,"font-medium"],[1,"grid","grid-cols-2","pt-5","gap-4"],[1,"grid","grid-cols-1","gap-3"],[4,"ngFor","ngForOf"],[1,"w-full","h-50","col-span-2",3,"latitude","longitude","zoom"],[3,"latitude","longitude"],["class","grid grid-cols-2 gap-3 mt-3",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.YNc(0,mt,4,2,"div",0),e.YNc(1,ft,139,40,"div",1)),2&t&&(e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},directives:[a.O5,P.Ou,w.i,a.sg,j.SA,j.pt],pipes:[a.uU],encapsulation:2}),n})();var qt=l(3738);const vt=[{path:"",component:ue},{path:"new-request",component:G},{path:"preview/:id",component:_t},{path:"edit/:id",component:G}];let Zt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[a.ez,w.x,v.Bz.forChild(vt),M.U$,q.m,I.hJ,r.T,m.j,z.t,st.Ps,p.lN,U.c,R.ot,rt._8,c.u5,j.su,lt.i,ut.S,c.UX,Y.EV,ct.O,dt.WN,P.Cq,k.Bb,_.LD,E.FA,y.XK,qt.QW,$.q4,W.n,x.Is]]}),n})()},369:(X,N,l)=>{l.d(N,{P:()=>v,n:()=>I});var a=l(7716),b=l(8583),e=l(805),C=l(5593),w=l(982),p=l(7238),_=l(9592);function y(m,q){if(1&m&&a._UZ(0,"i",8),2&m){const r=a.oxw(2);a.Tol(r.confirmation.icon),a.Q6J("ngClass","p-confirm-popup-icon")}}function U(m,q){if(1&m){const r=a.EpF();a.TgZ(0,"button",9),a.NdJ("click",function(){return a.CHM(r),a.oxw(2).reject()}),a.qZA()}if(2&m){const r=a.oxw(2);a.Tol(r.confirmation.rejectButtonStyleClass||"p-button-text"),a.Q6J("icon",r.confirmation.rejectIcon)("label",r.rejectButtonLabel)("ngClass","p-confirm-popup-reject p-button-sm"),a.uIk("aria-label",r.rejectButtonLabel)}}function c(m,q){if(1&m){const r=a.EpF();a.TgZ(0,"button",9),a.NdJ("click",function(){return a.CHM(r),a.oxw(2).accept()}),a.qZA()}if(2&m){const r=a.oxw(2);a.Tol(r.confirmation.acceptButtonStyleClass),a.Q6J("icon",r.confirmation.acceptIcon)("label",r.acceptButtonLabel)("ngClass","p-confirm-popup-accept p-button-sm"),a.uIk("aria-label",r.acceptButtonLabel)}}const R=function(m,q){return{showTransitionParams:m,hideTransitionParams:q}},M=function(m){return{value:"open",params:m}};function T(m,q){if(1&m){const r=a.EpF();a.TgZ(0,"div",1),a.NdJ("click",function(g){return a.CHM(r),a.oxw().onOverlayClick(g)})("@animation.start",function(g){return a.CHM(r),a.oxw().onAnimationStart(g)})("@animation.done",function(g){return a.CHM(r),a.oxw().onAnimationEnd(g)}),a.TgZ(1,"div",2,3),a.YNc(3,y,1,3,"i",4),a.TgZ(4,"span",5),a._uU(5),a.qZA(),a.qZA(),a.TgZ(6,"div",6),a.YNc(7,U,1,6,"button",7),a.YNc(8,c,1,6,"button",7),a.qZA(),a.qZA()}if(2&m){const r=a.oxw();a.Tol(r.styleClass),a.Q6J("ngClass","p-confirm-popup p-component")("ngStyle",r.style)("@animation",a.VKq(12,M,a.WLB(9,R,r.showTransitionOptions,r.hideTransitionOptions))),a.xp6(3),a.Q6J("ngIf",r.confirmation.icon),a.xp6(2),a.Oqu(r.confirmation.message),a.xp6(2),a.Q6J("ngIf",!1!==r.confirmation.rejectVisible),a.xp6(1),a.Q6J("ngIf",!1!==r.confirmation.acceptVisible)}}let v=(()=>{class m{constructor(r,h,g,A,D,L){this.el=r,this.confirmationService=h,this.renderer=g,this.cd=A,this.config=D,this.overlayService=L,this.defaultFocus="accept",this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.autoZIndex=!0,this.baseZIndex=0,this.subscription=this.confirmationService.requireConfirmation$.subscribe(S=>{S?S.key===this.key&&(this.confirmation=S,this.confirmation.accept&&(this.confirmation.acceptEvent=new a.vpe,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new a.vpe,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0):this.hide()})}get visible(){return this._visible}set visible(r){this._visible=r,this.cd.markForCheck()}onAnimationStart(r){if("open"===r.toState){this.container=r.element,document.body.appendChild(this.container),this.align(),this.bindListeners();const h=this.getElementToFocus();h&&h.focus()}}onAnimationEnd(r){switch(r.toState){case"void":this.onContainerDestroy()}}getElementToFocus(){switch(this.defaultFocus){case"accept":return _.p.findSingle(this.container,".p-confirm-popup-accept");case"reject":return _.p.findSingle(this.container,".p-confirm-popup-reject");case"none":return null}}align(){this.autoZIndex&&w.P9.set("overlay",this.container,this.config.zIndex.overlay),_.p.absolutePosition(this.container,this.confirmation.target);const r=_.p.getOffset(this.container),h=_.p.getOffset(this.confirmation.target);let g=0;r.left<h.left&&(g=h.left-r.left),this.container.style.setProperty("--overlayArrowLeft",`${g}px`),r.top<h.top&&_.p.addClass(this.container,"p-confirm-popup-flipped")}hide(){this.visible=!1}accept(){this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide()}reject(){this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(),this.hide()}onOverlayClick(r){this.overlayService.add({originalEvent:r,target:this.el.nativeElement})}bindListeners(){this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener()}unbindListeners(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener()}bindDocumentClickListener(){if(!this.documentClickListener){let r=_.p.isIOS()?"touchstart":"click";const h=this.el?this.el.nativeElement.ownerDocument:document;this.documentClickListener=this.renderer.listen(h,r,g=>{let A=this.confirmation.target;this.container!==g.target&&!this.container.contains(g.target)&&A!==g.target&&!A.contains(g.target)&&this.hide()})}}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}onWindowResize(){this.hide()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new _.V(this.confirmation.target,()=>{this.visible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unsubscribeConfirmationSubscriptions(){this.confirmation&&(this.confirmation.acceptEvent&&this.confirmation.acceptEvent.unsubscribe(),this.confirmation.rejectEvent&&this.confirmation.rejectEvent.unsubscribe())}onContainerDestroy(){this.unbindListeners(),this.unsubscribeConfirmationSubscriptions(),this.autoZIndex&&w.P9.clear(this.container),this.confirmation=null,this.container=null}restoreAppend(){this.container&&document.body.removeChild(this.container),this.onContainerDestroy()}get acceptButtonLabel(){return this.confirmation.acceptLabel||this.config.getTranslation(e.ws.ACCEPT)}get rejectButtonLabel(){return this.confirmation.rejectLabel||this.config.getTranslation(e.ws.REJECT)}ngOnDestroy(){this.restoreAppend(),this.subscription&&this.subscription.unsubscribe()}}return m.\u0275fac=function(r){return new(r||m)(a.Y36(a.SBq),a.Y36(e.YP),a.Y36(a.Qsj),a.Y36(a.sBO),a.Y36(e.b4),a.Y36(e.F0))},m.\u0275cmp=a.Xpm({type:m,selectors:[["p-confirmPopup"]],hostAttrs:[1,"p-element"],inputs:{key:"key",defaultFocus:"defaultFocus",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",style:"style",styleClass:"styleClass",visible:"visible"},decls:1,vars:1,consts:[[3,"ngClass","ngStyle","class","click",4,"ngIf"],[3,"ngClass","ngStyle","click"],[1,"p-confirm-popup-content"],["content",""],[3,"ngClass","class",4,"ngIf"],[1,"p-confirm-popup-message"],[1,"p-confirm-popup-footer"],["type","button","pButton","",3,"icon","label","ngClass","class","click",4,"ngIf"],[3,"ngClass"],["type","button","pButton","",3,"icon","label","ngClass","click"]],template:function(r,h){1&r&&a.YNc(0,T,9,14,"div",0),2&r&&a.Q6J("ngIf",h.visible)},directives:[b.O5,b.mk,b.PC,C.Hq],styles:['.p-confirm-popup{position:absolute;margin-top:10px;top:0;left:0}.p-confirm-popup-flipped{margin-top:0;margin-bottom:10px}.p-confirm-popup:after,.p-confirm-popup:before{bottom:100%;left:calc(var(--overlayArrowLeft, 0) + 1.25rem);content:" ";height:0;width:0;position:absolute;pointer-events:none}.p-confirm-popup:after{border-width:8px;margin-left:-8px}.p-confirm-popup:before{border-width:10px;margin-left:-10px}.p-confirm-popup-flipped:after,.p-confirm-popup-flipped:before{bottom:auto;top:100%}.p-confirm-popup.p-confirm-popup-flipped:after{border-bottom-color:transparent}.p-confirm-popup.p-confirm-popup-flipped:before{border-bottom-color:transparent}.p-confirm-popup .p-confirm-popup-content{display:flex;align-items:center}\n'],encapsulation:2,data:{animation:[(0,p.X$)("animation",[(0,p.SB)("void",(0,p.oB)({transform:"scaleY(0.8)",opacity:0})),(0,p.SB)("open",(0,p.oB)({transform:"translateY(0)",opacity:1})),(0,p.eR)("void => open",(0,p.jt)("{{showTransitionParams}}")),(0,p.eR)("open => void",(0,p.jt)("{{hideTransitionParams}}"))])]},changeDetection:0}),m})(),I=(()=>{class m{}return m.\u0275fac=function(r){return new(r||m)},m.\u0275mod=a.oAB({type:m}),m.\u0275inj=a.cJS({imports:[[b.ez,C.hJ]]}),m})()}}]);